\documentclass[11pt,reqno]{amsart}
%prepared in AMSLaTeX, under LaTeX2e
\addtolength{\oddsidemargin}{-.65in}
\addtolength{\evensidemargin}{-.65in}
\addtolength{\topmargin}{-.3in}
\addtolength{\textwidth}{1.5in}
\addtolength{\textheight}{.6in}

\renewcommand{\baselinestretch}{1.1}

\usepackage{verbatim} % for "comment" environment

\usepackage[pdftex, colorlinks=true, plainpages=false, linkcolor=blue, citecolor=red, urlcolor=blue]{hyperref}

\newtheorem*{thm}{Theorem}
\newtheorem*{defn}{Definition}
\newtheorem*{example}{Example}
\newtheorem*{problem}{Problem}
\newtheorem*{remark}{Remark}

\newcommand{\mtt}{\texttt}
\usepackage{alltt,xspace}
\usepackage[normalem]{ulem}
\newcommand{\mfile}[1]
{\medskip\begin{quote}\scriptsize \begin{alltt}\input{#1.m}\end{alltt} \normalsize\end{quote}\medskip}

\usepackage[final]{graphicx}
\newcommand{\mfigure}[1]{\includegraphics[height=2.5in,
width=3.5in]{#1.eps}}
\newcommand{\regfigure}[2]{\includegraphics[height=#2in,
keepaspectratio=true]{#1.eps}}
\newcommand{\widefigure}[3]{\includegraphics[height=#2in,
width=#3in]{#1.eps}}

% macros
\usepackage{amssymb}

\usepackage[T1, OT1]{fontenc}
\renewcommand{\dh}{\fontencoding{T1}\selectfont{\symbol{240}}}

\newcommand{\bod}{B\"o\dh varsson\xspace}
\newcommand{\bods}{B\"o\dh varsson's}
\newcommand{\citebod}{B\"o\dh varsson (1955)\xspace}
\newcommand{\citepbod}{(B\"o\dh varsson, 1955)\xspace}

\newcommand{\bA}{\mathbf{A}}
\newcommand{\bB}{\mathbf{B}}
\newcommand{\bE}{\mathbf{E}}
\newcommand{\bF}{\mathbf{F}}
\newcommand{\bJ}{\mathbf{J}}
\newcommand{\br}{\mathbf{r}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\hbi}{\mathbf{\hat i}}
\newcommand{\hbj}{\mathbf{\hat j}}
\newcommand{\hbk}{\mathbf{\hat k}}
\newcommand{\hbn}{\mathbf{\hat n}}
\newcommand{\hbr}{\mathbf{\hat r}}
\newcommand{\hbt}{\mathbf{\hat t}}
\newcommand{\hbx}{\mathbf{\hat x}}
\newcommand{\hby}{\mathbf{\hat y}}
\newcommand{\hbz}{\mathbf{\hat z}}
\newcommand{\hbphi}{\mathbf{\hat \phi}}
\newcommand{\hbtheta}{\mathbf{\hat \theta}}
\newcommand{\complex}{\mathbb{C}}
\newcommand{\ppr}[1]{\frac{\partial #1}{\partial r}}
\newcommand{\ppt}[1]{\frac{\partial #1}{\partial t}}
\newcommand{\ppx}[1]{\frac{\partial #1}{\partial x}}
\newcommand{\ppy}[1]{\frac{\partial #1}{\partial y}}
\newcommand{\ppz}[1]{\frac{\partial #1}{\partial z}}
\newcommand{\pptheta}[1]{\frac{\partial #1}{\partial \theta}}
\newcommand{\ppphi}[1]{\frac{\partial #1}{\partial \phi}}
\newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\ppp}[2]{\frac{\partial^2 #1}{\partial^2 #2}}
\newcommand{\pppp}[3]{\frac{\partial^2 #1}{\partial #2 \partial #3}}
\newcommand{\Div}{\ensuremath{\nabla\cdot}}
\newcommand{\Curl}{\ensuremath{\nabla\times}}
\newcommand{\curl}[3]{\ensuremath{\begin{vmatrix} \hbi & \hbj & \hbk \\ \partial_x & \partial_y & \partial_z \\ #1 & #2 & #3 \end{vmatrix}}}
\newcommand{\cross}[6]{\ensuremath{\begin{vmatrix} \hbi & \hbj & \hbk \\ #1 & #2 & #3 \\ #4 & #5 & #6 \end{vmatrix}}}
\newcommand{\eps}{\epsilon}
\newcommand{\grad}{\nabla}
\newcommand{\image}{\operatorname{im}}
\newcommand{\integers}{\mathbb{Z}}
\newcommand{\ip}[2]{\ensuremath{\left<#1,#2\right>}}
\newcommand{\lam}{\lambda}
\newcommand{\lap}{\triangle}
\newcommand{\Matlab}{\textsc{Matlab}\xspace}
\newcommand{\exers}[1]{\bigskip\noindent\textbf{Exercises} #1}
\newcommand{\fexer}[2]{\bigskip\noindent\textbf{Lesson #1, \##2}\quad }
\newcommand{\prob}[1]{\bigskip\noindent\textbf{#1} }
\newcommand{\pts}[1]{(\emph{#1 pts}) }
\newcommand{\epart}[1]{\medskip\noindent\textbf{(#1)}\quad }
\newcommand{\ppart}[1]{\,\textbf{(#1)}\quad }
\newcommand{\note}[1]{[\scriptsize #1 \normalsize]}
\newcommand{\MatIN}[1]{\mtt{>> #1}}
\newcommand{\onull}{\operatorname{null}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\range}{\operatorname{range}}
\renewcommand{\P}{\mathcal{P}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\trace}{\operatorname{tr}}
\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}
\newcommand{\Arg}{\operatorname{Arg}}

\newcommand{\comm}[2]{\item \emph{#1}:\, #2}

\renewcommand{\ln}[2]{\comm{line #1}{#2}}
\newcommand{\lnpage}[3]{\comm{line #1 \underline{on page #2}}{#3}}
\newcommand{\lns}[2]{\comm{lines #1}{#2}}
\newcommand{\lnspage}[3]{\comm{lines #1 \underline{on page #2}}{#3}}
\newcommand{\fg}[2]{\comm{Figure #1}{#2}}
\newcommand{\eqn}[2]{\comm{equation #1}{#2}}

\newcommand{\reply}[2]{
\medskip\medskip
\item  \begin{quote}
\emph{#1}
\end{quote}

\medskip
\noindent #2}


\title[Replies to Referee Comments]{Replies to all referee comments on \\ \emph{Mass-conserving subglacial hydrology in PISM}}

\author{Ed Bueler}

\date{\today}

\begin{document}
\maketitle

\thispagestyle{empty}

We thank the reviewers for many thoughtful comments.  Indeed, there are 19 pages worth of (formatted) reviewer comments below, and our replies take another 21 pages, yielding this long 40 page document.

As emphasized by the editor and some reviewers, the paper should be shortened, and we have done so.  Specifically we replace section 6 and subsection 7.4\footnote{Unless otherwise stated, numbering refers to the \emph{old} version, not the revised manuscript.} by brief text summaries.  Table 3 and Figure 6 have been removed.  Just as significant, exposition has been made briefer.  As a result the two-column-format length of the text portion of the paper, i.e.~not counting Tables and Figures but including References, has shrunk from 18.75 pages to 15.5 pages, a reduction of 17\%.  The accompanying \texttt{latexdiff} output is enormous because essentially every paragraph has been revised, and most shortened.

While the reviewers disagree, at times, with the way we describe our results, and with the processes we choose to include in the model, these reviews do not assert that anything in the paper is \emph{wrong}.  There is no assertion that our model is wrong in the sense of not being compatible with physical principles, deductively wrong, or that numerical schemes are inconsistent or nonconvergent.

Instead, the majority of the reviewers' comments amount to asking us to add process models and add commentary, or to change our conceptual picture to match theirs.  This has been resisted.  Furthermore, it is frustrating that none of the reviewers seem to be seriously interested in, or have apparent experience in, applying models of any type at whole ice sheet scale, which is clearly our emphasis.  Our model is already a super-model of four (identified) important subglacial hydrology models in the literature, two of which are essentially always applied to ice sheets and not glaciers \cite{Siegertetal2009,Tulaczyketal2000}, and we have demonstrated this super-model at unprecedented scale.  We have a sense that this is all overlooked in the quest for conduits and true englacial storage, which we have good, and clearly-stated, reasons for not including.  Regarding conduits, we make clear our intent to stick to continuum physics, as that physical paradigm is the only accepted one in climate and fluid modeling.

\emph{Scalability}, so that the model can apply at high resolution to a whole ice sheet, and \emph{configurability}, so that climate modelers inexperienced in fiddling with subglacial hydrology models can still use it, are goals which dominate the design of the model.  These goals motivate many replies below.


\subsection*{Comments by Editor Goldberg}\begin{itemize}
\reply{There are now 3 very helpful and insightful reviews from 3 very qualified and industrious referees.  I think that all their major concerns have merit, and I ask that you make efforts to address these concerns.  There maybe a couple of typos in reviewer 3's review, and I disagree that $W_{eng}$ is unaccounted for (it just may need to be added to some early equations)---but there are some very good points made about the difference between your model and the Schoof 2012 model with respect to the regions where pressure is either overburden or zero. \dots I hope that you can address all of these concerns, as I expect this to be a very valuable addition to GMD.}
{We believe we have addressed the reviewers' comments.  Furthermore, we have non-trivially revised the paper in useful ways for the reader. \\
\indent While we appreciate the industriousness of the referees, we would also like to point out the narrowness of their expressed concerns.  The history of ice sheet dynamics modelling suggests there is a huge difference between equations that might work at glacier scale versus equations that make sense at whole ice sheet spatial scale, on long time-scale integrations, and at high resolution, simultaneously.  There is no evidence that subglacial hydrology modelling is, or will be, any different.  One has to make nontrivial theoretical compromises to extend real physical principles to large scale.  These compromises, and their motivations, are a major feature of the paper.  Applications to which a scalable model might be put (esp.~subglacial lake identification under ice sheets, and the modeling of the thermodynamically-dominated basal shear stress under ice streams) are indicated as motivation of our work in many places.  The paper has ``ice sheet'' in the title and it was submitted to a ``model development'' journal which will have primarily a large-climate modeling audience, and we believe our model's scope and choices are highly-appropriate to this context.}

\reply{I want to highlight something that Dr Bartholomaus mentioned, offhand that the coupling is essentially one-way, because melt rate affects $N_{til}$, and thus yield stress, locally and $P/W$ do not in any way feed back on it. \dots}
{In our model basal melt rate affects both $W_{til}$ and $W$, through conservation of mass, and this results in changes in $P$.  This causal direction is already very important for understanding hydrology.  Exploring the consequences of hydrology at large scale under ice sheet has barely begun in the literature.\\
\indent However, only the effective thickness of water in the till ($W_{til}$) has an immediate effect on the effective pressure on the till ($N_{til}$).  Thus only $W_{til}$ has an immediate effect on the till yield stress $\tau_c$, and this key fact in the model is something we think is a feature; \emph{our model extends the best-understood hydrology/dynamics feedback, which is the plastic bed till-based model of} \cite{Tulaczyketal2000}.  Our conservative, i.e.~drained, version of that model improves it, as opposed to just launching into an unknown region of parameter space.  \emph{Not} guessing wildly about how cavity and/or conduit pressures affect the plastic bed paradigm is a feature here, not a bug. \\
\indent Indeed, our point in modeling till is that the actual evidence for sustained patterns of weak and strong bed under significant areas of ice sheets is based on till, and thus our use of the Tulaczyk et al.~(2000) \cite{Tulaczyketal2000} model is highly appropriate.  Our use of a sliding law is also physical and appropriate; see our responses to Dr.~Bartholomaus' comments on this topic. \\
\indent On the other hand, as explained in multiple PISM-related and other papers on membrane stresses, there are extensive non-local connections between the basal shear stress, i.e.~on coefficient $\tau_c$ by the sliding law, back to sliding speed $|\mathbf{v}_b|$ and basal melt rate $m$.  The last two quantities affect $W_{til}$ and $W$ and $P$ in highly non-trivial ways.  The coupling is already complicated, and adding complexity is not always desireable.}

\reply{\dots  This is why I asked initially if there was some way of allowing conduit pressure to influence till storage.  I don't remember this being emphasized anywhere in the text, and that it should be. (this also bears on Dr Bartholomaus's comment on the mixing it is indeed odd for the ice flow to be opening up cavities, and yet the normal stress of the asperities not affecting basal velocity.)}
{There are many ways to connect conduit pressure to till storage.  Indeed, there being no observations to constrain such a parameterization, we could implement in PISM whichever one you liked, according to whatever dynamics you intend to generate.\footnote{Acknowledging that this is a ``snarky'' reply, we feel this really describes the situation.  A model that has till, and cavities, and conduits, and englacial storage has a lot of parameters.  It can do anything you want.  We are already at great risk this way, and it is time to stop adding parameters to our model and start trying to use ice-sheet-wide observations to constrain it.} \\
\indent Regarding Dr.~Bartholomaus' comments on ``mixing'' soft-bed and hard-bed concepts, there are two ways to answer.  One is that the large hard-bed subglacial hydrology modeling literature ignors the presence of till at the bottom of every borehole drilled to the bed where the presence or absence of till can be assessed; we know of no exceptions to this rule and none are offered by reviewers.  The other is that there is a perfectly reasonable expectation that cavities form in soft bed through a sliding instability \cite{Schoof2007deformable}.}
\end{itemize}


\subsection*{Comments by Dr.~Bartholomaus}\begin{itemize}

\reply{In this manuscript, the authors present a novel extension of the existing Parallel Ice Sheet Model that includes the most complete treatment to date of subglacial hydrology in a large-scale ice sheet model.  Subglacial hydrology is immensely important in glacier dynamics, but is often neglected in the major ice sheet models used to predict future sea level rise.  The computational expense of tracking changes in the rapidly evolving subglacial environment has generally prevented all but the crudest of parameterizations (see table 2 of Bindschadler 2013's summary of the SeaRISE experiment).\\
Thus, the present work is novel and worthy of publication in GMD.  The writing is generally clear and fluent.  Both the theoretical development of the continuum equations and the numerical implementation are clearly outlined.}
{We appreciate this summary and the comments below, which have improved the text.}

\reply{Beyond these over-arching strengths, I have four critiques that I believe would significantly enhance the impact and accessibility of the manuscript. These four opportunities for improvement are below. My line edits follow these more significant points.\\
---Four significant opportunities---\\
+ The authors offer some comparison between
their model and those of Werder, Hewitt, Flowers, Schoof, etc., but these are generally smaller scale models that have yet to be implemented or applied at the ice sheet
scale, and rarely to the complex geometries of existing glaciers or ice sheets. Some
discussion regarding how the new PISM hydrology model compares with the hydrology models of other major ice sheet models, such as those discussed in the SeaRISE
project would be very valuable.  At present, comparison to existing ice sheet models is
entirely lacking.  Without much knowledge of these models myself, I suspect that the
present model may represent a significant advance over the implementations in other
ice sheet models.  If appropriate, the authors may consider adding a sentence regarding this comparison to the abstract.  Also, by way of review, please consider adding a
table comparing features of presently-used ice sheet models.}
{We \emph{do} compare to existing large-scale models, by describing and citing the work of \cite{Goeller2014,LeBrocqetal2009,Livingstoneetal2013,Siegertetal2009}.  Such find-the-subglacial-lakes-and-drainage-paths modeling, which either uses an ill-posed version of our well-posed overburden-pressure-based \texttt{routing} model, or a balance velocity model, is the only whole-ice-sheet-scale work we know about.\footnote{We care about this whole ice sheet scale application.  The fact that we are building an improvement of the \cite{Goeller2014,LeBrocqetal2009,Livingstoneetal2013,Siegertetal2009} models is important to us, clearly stated in the paper, and never mentioned by reviewers.}  We have also added a citation to \cite{HoffmanPrice2014}, which describes the construction of a related hydrology submodel within the Community Ice Sheet Model, but which is applied only at the scale of a single idealized mountain glacier in \cite{HoffmanPrice2014}.\footnote{It has not yet been applied at whole ice sheet scale (S.~Price personal communication).}\\
\indent We believe it would be inappropriate, and a surprising use of space, to add a table comparing features of presently-used ice sheet models in a PISM model-description paper.  It is already an inherent deficiency of model description papers that they can only describe a snapshot of an evolving piece of software.  Snapshotting other software projects, many of which, unlike PISM, do not have open development heads, would only make this worse.}

\reply{+ Considering that efficient, low-pressure conduits are such important features of the subglacial hydrologic system, some discussion/justification of why a model without conduits is useful is necessary.  While consistent model behavior under grid refinement is certainly tremendously valuable, if one of the fundamental processes (i.e., transport of water in conduits) is entirely neglected, then all the model results may be called into question.  The present model is still an improvement on the general lack of subglacial hydrology in existing ice sheet models, but ideally, conduits will be included in future generations of ice sheets.}
{We discuss why a conduit model is not included in our model, and we have amplified our points in the revised version.\\
\indent  At present, \emph{all} 2D conduit models are \emph{not physics} by the normal standards of the field (e.g.~the field ``climate modeling'' or ``fluid modeling'' or ``continuum physics'', according to taste).  Note that ``consistent model behavior under grid refinement,'' in the sense used by this reviewer, is normally called ``continuum physics'', and has been the standard for physics since Fourier and Maxwell.\footnote{Numerical model behaviour under ``grid refinement'', as used in the field of numerical approximations of continuum physics, and as normal in geoscientific models, is the very different concept of numerical convergence to the solution of a differential equation.  It is directly addressed by our verification case.} \\
\indent We clearly state that the existing lattice models of 2D conduits can't work in a user-controlled large-scale ice dynamics model, and that for that reason we do not add them.  That these models are useful for process exploration is not denied or disputed.\\
\indent Linked-cavities could also be forced onto the nodes of a 2D lattice, but we, and \emph{all} existing 2D models, do not put them on a lattice.  That is because we (collectively) \emph{do} have the PDE which describes the effect of a linked cavity system as continuum physics.  We have added this point to the paper. \\
\indent We encourage this reviewer, and the other reviewers who we also believe (by their questions) are interested in including conduits into subglacial hydrology models, to proceed in the normal manner of physics and attempt to develop a PDE description (i.e.~a lattice-free formulation) of conduit effects.  Or they can apply an actual conduit formation model to whole ice sheet scale, that is, one the causes a conduit to appear at the location where the data suggests it should, not where lattice location input data forces it.  To complain that we have not invented the former ourselves, or made a model trillions of times more efficient than existing models so that we can claim the latter, is unfair.\\
\indent That ``all the model results may be called into question'' is the normal state of affairs in climate modeling.  But this phrase profoundly explains why we \emph{don't} use lattice models.  We will not risk having a user of PISM, in runs coupled to a GCM, have a reviewer of the results correctly point out that there was a single subsystem in the entire coupled mess which was not using the usual translation-invariant structures of physics \dots namely a 2D lattice model of subglacial conduits.\\
\indent We completely agree that ``ideally conduits will be included in future
generations of ice sheet [models]''.}

\reply{+ This manuscript and model includes an ambiguous mixing of hard-bedded and soft-bedded ideas. For example, the model includes opening and closing of cavities at
the glacier bed, driven by basal sliding (section 2.5).  This is generally considered
a hard-bedded view of basal hydrology and motion.  However, the description of the
Mohr-Coulomb yield stress for till (section 3.2) is appropriate for soft beds and basal
motion accomplished by deformation \emph{within} the till, not at the interface between the
till and the glacier ice. Similarly, the sliding law that depends on the till's yield stress
(section 3.3) is also a soft-bedded concept. The combination of soft- and hard-bedded
ideas in this model appears to be inappropriate or at least confusing. \dots}
{We are not quite sure why our mixing of hard- and soft-bedded morphology is ``ambiguous''.  The equations are clear.\\
\indent Though the reviewer may not have read it, we cite \cite{Schoof2007deformable} which models the formation of cavities, by sliding, in a deformable subglacial till.  This is precisely a ``combination of soft- and hard-bedded ideas'' for ``opening and closing of cavities at the glacier bed, driven by basal sliding'' in the sense used by the reviewer.  We also cite \cite{vanderWeletal2013} which uses till essentially as we do, combined with a conduit in a 1D model. \\
\indent The literature of subglacial hydrology usually avoids including till in model-based exploration of hard-bed processes, but we can't find a single published (or unpublished) example of a till-free bed-reaching borehole in ice, and none are offered by reviewers.  Because we expect, based on the observations that do exist, that the majority of the ice overburden pressure of an ice sheet, in non-frozen areas, is supported by saturated till, we include a model for its strength, namely Mohr-Coulomb. \\
\indent Yes, the Mohr-Coulomb model for the yield stress for till is appropriate for soft beds and basal motion accomplished by deformation within the till.  However, basal \emph{ice} deformation may occur in a thin (meters) layer of temperate ice with high water and sediment content. This deformation, and also notional hard-bed sliding if it occurs, are all modeled in the current literature by power-law sliding relations.  An ice sheet model, and the actual data available to constrain it,\footnote{Esp.~DEM, surface velocity, and bed elevation, but also, increasingly, isochrones and layer geometry.} cannot distinguish these mechanisms occurring close to the bed. \\
\indent Finally, as stated in section 3.3, our computed yield stress value $\tau_c$ is used as a physically-meaningful coefficient in a power law for sliding \cite{AschwandenAdalgeirsdottirKhroulev}, and such power laws are effectively regularized Coulomb stress models in the range of powers we use \cite{SchoofCoulombBlatter}.  Having the coefficient of the sliding law be physically meaningful, and being tied to modeled basal water pressure so that it can physically evolve, is both conceptually and practically better then providing a sliding law with no physical meaning of, or physically-based way to model the temporal- or spatial-variation of, the coefficient.}

\reply{\dots  Furthermore, the description of 1-way and 2-way coupling could be more clear. If the rate of basal motion ($u_b$ or $v_b$) is an input to the model, then why is there a section on the sliding law (section 3.3)?}
{Section 3.3 is included exactly to give meaning to the yield stress $\tau_c$ as a submodel \emph{output}, something clearly stated in several places, including Table 2.  Because this is a model description paper for a submodel of PISM, we are obliged to state what the inputs and outputs of the submodel are.\\
\indent One connection between $\mathbf{v}_b$ and $\tau_c$ is our hydrology model.  The other is the whole ice dynamics model of PISM, which ice-sheet-modeler readers know takes boundary stress as an input and produces velocity as an output.  This ice dynamics model is well-described in literature we cite. \\
\indent As hinted above, in the most common use of sliding laws in ice sheet modeling, the coefficient in the sliding law has \emph{no} physical meaning.  It is often set by inversion of surface velocities, thus totally by-passing a process-based description of how it might evolve.  We think that having mass-conservation for liquid water in the subglacial system, and using a physically-based computation of the coefficient in a sliding law, is a preferred situation.}

\reply{\label{inversepage} + It is interesting and surprising to note that you find an inverse relationship between water pressure and basal motion for systems at steady state. This is contrary to almost all prevailing sliding laws.  Is [it] a result of the 1-way coupling ($v_b$ that does not directly depend on water pressure)? Whatever the cause, it is sufficiently surprising to warrant additional discussion.}
{We include an analysis of steady states because this analysis is not done elsewhere for the (now) standard linked-cavity system equations \cite{Hewitt2011,Schoofetal2012}.  Our first point is that these equations imply a functional form $P(W)$ at steady state, and thus that Flowers and Clarke \cite{FlowersClarke2002} are not crazy to propose such.\\
\indent Indeed there emerges a ``inverse relationship between water pressure and basal motion for systems at steady state'' from this analysis.  Why is this surprising?  Basal motion generates cavities (i.e.~space for the water to fill), so the pressure drops.  Said another way (as we do in the paper), sliding increases the opening rate, so if creep closure must balance it then the pressure will drop, to speed the closure, unless there is a simultaneous increase of water into the system (which does not happen at steady state).  We presumed this observation, \emph{which is not offered as a ``sliding law'' at all}, and indeed should not be used that way, was standard.  In any case it follows from the equations, the reviewers don't believe our analysis is in error, and we have included it with the prominence we believe it deserves. \\
\indent Presumably the idea is surprising because the reviewer believes in sliding laws.  Regarding the idea that the sliding velocity ``does not directly
depend on water pressure'', we remark that sliding laws usually relate the basal shear stress applied to the ice \emph{and} the water pressure \emph{and} the ice base velocity.  Equation (25) in section 3.3 is thus a sliding law, and it is the one that we offer.  It is utterly standard, except that it (appropriately) includes the Coulomb case ($q=0$) and it has a water-pressure-linked coefficient with physically-meaningful units. \\
\indent  The presence of longitudinal stresses in the ice implies that there is globalized connection from water pressure back to sliding velocity, via (e.g.) stress boundary conditions at the boundary of the ice fluid mass (i.e.~the glacier).  This connection via a stress balance is outside of the scope of this submodel description paper, but is described at length in \cite{BBssasliding} and other citations.\\
\indent Our analysis of steady states is not offered as a sliding law, and in that sense the reviewer is correct that our analysis ``is a result of the 1-way coupling.'' That is, conservation of momentum in the \emph{ice}---especially, the applied stress  on the base of the ice---plays no role in the relationship.  The relationship simply follows from equations (13), (14), (15) in their steady state cases, as clear in the paper.}

\reply{---Line Edits---\\
p.~4706, l.~26 Also consider citing Walder 1982 if your purpose is to highlight some of
the early work here.}
{We cite Walder (1982) on line 22 of page 4708.  We use Creyts and Schoof at this point on page 4706 because only stable (i.e.~viable) models of aquifer geometry are worth listing as alternatives which might go into a subglacial hydrology numerical model.}

\reply{p.~4707 l.~5 I think the best reference for englacial porosity is Fountain et al.~2005, from Storglaciaren.}
{These citations here are about models.  We already cite Fountain later when describing observations.}

\reply{p.~4708, l.~24 It may be worth mentioning that wall melt in linked cavities is generally
expected to be small (Kamb, 1987 and Bartholomaus et al., 2011)}
{We have added this comment, thanks.}

\reply{p.~4709, l.~1 What are the ramifications of neglecting to model conduits? Many observational studies (including work by Nienow, Mair, Anderson, Cowton, Harper) have
shown that efficient conduits are a fundamental component of subglacial hydrology.
How will your model provide insightful and realistic results without a conduit component?}
{We had assumed that models like \cite{Bartholomausetal2011}, which seem to explain the behavior of (rare) well-observed hydrological-plus-glacier-dynamics systems without using conduits, were of some value, but we may be wrong.\\
\indent Remember that the model is intended for whole ice sheet use.  We want, therefore, a \emph{well-posed extension} of the models used for identifying subglacial lakes \cite{LeBrocqetal2009,Siegertetal2009}, and we want a \emph{mass-conserving extension} of a successful (in terms of explaining surface velocity observations) ice stream basal stress model \cite{AschwandenAdalgeirsdottirKhroulev,BBssasliding,Tulaczyketal2000}.  While these purposes are all quite prominent in the paper we actually wrote, they are essentially ignored in reviewer comments.}

\reply{p.~4712, l.~17 It is not immediately clear to me why $\nabla H \gg \nabla W$. Where does this suggestion/observation come from?}
{We have revised the relevant sentence to say: ``If $P$ scales with the overburden pressure $P_o$ then the first term will dominate in the situation $|\nabla (H+b)| \gg |\nabla W|$''.  We no longer assert the situation is ``common''.\\
\indent This comment is in the context of explaining why, for nearly the first time, we have included ``$\rho_w g W$'' into the formula for hydraulic potential.  We presumed that the reason it is left out of nearly all prior literature is because that literature assumes that flow along the gradient of the (prior) hydraulic potential $\psi = P + \rho_w g b$ dominates over the gradient of the other part (i.e.~the gradient of the added part ``$\rho_w g W$'').  This is the \emph{only} case in which it would be acceptable to leave out the now-added part.  Furthermore, it is widely-accepted in the literature---for example, in the review paper \cite{Clarke05}---that gradients in $P$ follow gradient in the overburden pressure $P_o=\rho_i g H$, so that gradients in $P$ follow gradients in $H$.  \\
\indent So either: (i) all the prior literature is worthless (perfectly possible), or (ii) the case $|\nabla (H+b)| \gg |\nabla W|$ is worth considering as a way to relate our formulas to prior literature, and that is the spirit in which we consider it.  Our model only \emph{assumes} $|\nabla (H+b)| \gg |\nabla W|$ in a minor part of the given formula for the flux; see the next reply.}

\reply{p.~4712, l.~23 If here you assume that W $\ll$ b or P, and thus can be neglected in eq. 8, why have you made the distinction in eq. 2 and the discussion that follows to include the W term?}
{This question only makes sense if ``you assume that W $\ll$ b or P'' is interpreted as ``you assume that $|\nabla W| \ll |\nabla (H+b)|$''.  We do not compare values of $W$ (a thickness) to $b$ (an elevation) to $P$ (a pressure); we are comparing only gradients of distances to each other.\\
\indent As noted, the simplification is for simplicity, in particular for simplicity in the final implementation.  Despite the simplification we \emph{keep} the part of the flux proportional to $\grad W$, so the model is more complete than any other applied at ice sheet scale.  Furthermore, the simplified model is always diffusive for any pressure closure, and so, in particular, the \texttt{routing} model is well-posed unlike the related models in the prior literature \cite{LeBrocqetal2009,Siegertetal2009}. \\
\indent The simplification occurs inside our formula for the effective hydraulic conductivity $K$, which is wildy-uncertain in practice anyway.  That is, in the formula $K = k W^{\alpha-1} |\grad \psi|^{\beta-2}$, which appears throughout the literature, the correct values for coefficient $k$ and the powers $\alpha,\beta$ are all subject to minimally-constrained speculation.\footnote{We make this point in citations in subsection 2.3, which give a wide range of values for the same situations.}  We note that the simplification in question makes no difference at all if $\beta=2$, the value used in half of the cited work.}

\reply{p.~4713, l.~1 Near here, or somewhere else within the paper, please compare your
values for hydraulic conductivity [$k$] with those that may be calculated from field observations. Are your values in line with those found in the field? Googling ``subglacial
hydraulic conductivity'' yields several points of comparison.}
{We have looked and not found.  There is not a single observational paper we can find which argues that a directly-measurable value of the hydraulic conductivity is describing the average effect of a linked cavity system over the area of a grid cell relevant to this work (100 m to 5 km squares, say).  Values are, of course, always given when these papers include a \emph{model}---our Table 1 cites the default value of $k$ as from \cite{Schoofetal2012}---but one should be very skeptical that a value from applying one model to the data (supposing this is done) is still the right value when applying a different model to the data. \\
\indent Of course hydraulic conductivity for \emph{till} is given in literature, based on specific \emph{in situ} observational work.  Such values appear in the literature we cite, and they dominate the results from Googling ``subglacial hydraulic conductivity''.  But the till hydraulic conductivity value should not be used as $k$.  The conductivity of till is so low that water does not move laterally through till in a time, and over distances, which could explain any of the apparent behavior of water under glaciers and ice sheets.  Rather it is the macroscopic conductivity of the connected cavity network which is relevant.  Such a network can be present even as there is sediment (till) lying around; this is the situation we are modelling. \\
\indent  To quote \cite{Bartholomausetal2011}, which we already cite, \begin{quote}
\emph{Each of these three parameters, $\gamma$, $[k=]C\tau_b^n$, and $\phi$, is only weakly constrained by observations reported in the literature.  \dots $[k=]C\tau_b^n$ has units that depend on the exponent, and varies from $1.5\times 10^{-5}\, \text{m}\,\text{s}^{-1}\,\text{Pa}^{0.18}$ to $1.1\times 10^{-3}\, \text{m}\,\text{s}^{-1}\,\text{Pa}^{0.4}$ (Jansson, 1995; Sugiyama and Gudmundsson, 2004).}
\end{quote}
Is this ``weakly constrained'' result the kind of ``field observations'' meant by the reviewer?  Why should space in this model description paper be used to recapitulate such a weak and uncertain state of affairs?  The source of the default value of $k$ (Table 1) is, of course, cited, but we actually want to avoid asserting that any particular value of any constant is correct.  This is because we are building the model so users can relate its relatively-few parameters, $k$ among them, to rich, but often indirect, available data.  As pointed out in our paper, ``Darcy flux parameters $\alpha,\beta,k$ are also important [to the distribution of water thickness in the model results].  Parameter identification using observed surface data, though needed, is beyond the scope of this paper.''}

\reply{p.~4714, l.~15 Here and nearby: define $c_1$, $c_2$, and A.}
{We have done so.}

\reply{p.~4715, l.~6 Phrasing is ambiguous, as it makes it sound as though your model
potentially does not include till water storage beneath some parts of the ice sheet.}
{The issue is that the majority (by area) under the world's ice sheets does not have \emph{liquid} water under it, though it may have till.  The equations for till storage, transfer into the transport system, and weakening of the saturated till, must all reflect the amount of \emph{liquid} water there, not frozen water.  We model frozen locations as not having liquid water in the till, so $W_{til}=0$, and as being strong because $N_{til}$ is small (from (23) and (24)).  We have attempted to make this point clearer, without increased length.}

\reply{p.~4715, l.~20 Why not include lateral transport of water through till if vertical transport is included?  Till is often regarded as having an anisotropic hydraulic conductivity (e.g., Jones, 1993, ``A comparison of pumping and slug tests. . .'' in Ground Water vol.~31(6)).  Horizontal conductivity can be at least several times greater than vertical conductivity.}
{The reason for not including horizontal transport is the standard fact of ice sheet modeling generally, a fact which is even more applicable here: the flowing layers in ice sheet models are \emph{thin}.  In particular, any till thickness ever given in the literature is 1/1000 (or less) of the lateral distances traveled by subglacial water.  Anisotropy is irrelevant unless the horizontal conductivity can make up for this thinness.  As the reviewer's figures suggest, the conductivity in the horizontal is \emph{not} one thousand or more times the conductivity in the vertical.\\
\indent Of course, there is presumably a transport network of cavities, conduits, or thin sheets in addition, which has a low (lateral) macroscopic conductivity.  We attempt to model the first of these morphologies because stable continuum physics evolution equations are available for it.  The overall structure of the model is exactly what we believe is appropriate for water moving underneath ice sheets which have much of their overburden supported by saturated till: we model transport in combination with till storage, and the till is modeled as Mohr-Coulomb.}

\reply{p.~4715, l.~20 Is m in eq. 16 the same as m in eq. 1?  If so, these terms cancel out of
eq. 1.}
{Yes, $m$ in equation (16) is the same as in equation (1).  Yes, they cancel out when $W_{til}< W_{til}^{max}$, so that no water enters the transport network (i.e.~so that $\partial W/\partial t=0$ in (1)) in that case.  But we conserve water.  Thus if the right side of (16) is positive and also $W_{til} = W_{til}^{max}$, at a given location, then $\partial W_{til}/\partial t=0$, i.e.~we put no more water in till, and the water goes into the transport network ($W$) according to equation (1). \\
\indent We have attempted to clarify this logic here in section 3, and also in section 7 where numerical schemes are nailed down.}

\reply{p.~4715, l.~20 If $m/\rho$ is almost always bigger than $C_d$, then $dW_{til}/dt$ is always increasing up to the cap $W_{til}^{max}$. It would be useful to lay this out more explicitly, and include eq. 21 in this subsection. Essentially, you have a Boolean relationship, where in some places there is wet till and other places the till is frozen. Is model sensitive to selection of $W_{til}^{max}$?}
{Yes, when there is positive\footnote{Note that the majority by area of ice sheets are assumed to have frozen base, so $m\le 0$ there.} basal melt, then $m/\rho$ is almost always bigger than $C_d$, so that $dW_{til}/dt$ is always increasing up to the cap $W_{til}^{max}$.  The figures in section 9 reflect this. \\
\indent Though we would not say we have a ``Boolean relationship,'' we agree with the spirit of the reviewer's assertion.  We repeatedly emphasize that we enforce inequalities including (21), the bounds on $W_{til}$.  It follows that in some places there is wet till and other places the till is frozen; well-known reference \cite{BBssasliding} covers these ideas.  No, the model is not very sensitive to the selection of $W_{til}^{max}$, at least in areas of substantial basal melt rate.}

\reply{p.~4715, l.~24 Inclusion of $C_d$ with fixed value is poorly justified and seems very ad hoc.  Even if used by Tulaczyk, why is it necessary here and what is the model sensitivity to the selection of 1 mm a$^{-1}$?  A constant rate of till water drainage into the subglacial hydrologic system, that does not depend on pressure gradients, seems very odd.}
{We agree that Tulaczyk's \cite{Tulaczyketal2000} use of $C_d$ is ad hoc.  His model needs such a background loss of till-stored water, and ours too, but unlike him we have implemented a \emph{conservation} model.  We keep track of all the water globally, but we need previously wet areas which no longer have water input to not be eternally weak (i.e.~permanently remain with till full of liquid water).\\
\indent In areas resembling anything in the present-day northern hemisphere, with relatively high basal melt rates, the model is insensitive to $C_d$.  In areas of very low melt rate (e.g.~EAIS) there is a time-scale sensitivity.  We have no time-dependent information about changes in EAIS subglacial melt rates with which to constrain values.  The implication that we should use something complicated (which is the only alternative to ``ad hoc'' here) simply implies adding more unconstrained parameters. \\
\indent If the reviewer has a 2D, data-supported, physics-based, applicable-at-large-scale model of how till and a linked-cavity (or other) system interact, then we hope he publishes that.  We can't find it, and this paper proposes a simple alternative which arises from the only observation-supported literature which we know about which is related to these processes \cite{Tulaczyketal2000}.  We seek relative simplicity and few parameters, instead of implementing process speculation.}

\reply{p.~4717, l.~1 What is the effect of this choice? How was it selected?}
{The value $\delta=0.02$ is based on the observations that subglacial water pressure at the bottoms of boreholes, i.e.~in till, have pressure within a few percent of overburden pressure.  The particular value used means that fully-saturated till has water pressure which is $(1-0.02)P_o=0.98 P_o$.  This parameter \emph{is} very influential on sliding, and is explored the right way (i.e.~by using lots of observations of surface velocity) in \cite{AschwandenAdalgeirsdottirKhroulev}, using the earlier PISM model of non-conserving subglacial hydrology.}

\reply{p.~4718, l.~16 I recommend changing the title of this section to ``Basal motion relation'' or some other phrase. ``Sliding law'' implies slip at the interface between the ice and its bed, whether bedrock or sediment, whereas your equation for yield stress (eq. 17) is appropriate for till deformation.}
{Ice sheet modelers use ``sliding law'' the way we do, that is, Equation (25) is called a sliding law by all readers familiar with ice sheet modeling, the target audience of this paper. \\
\indent  Ice sheet models can't make the distinction implied by this reviewer.  That is, there is no distinction in results in any existing ice sheet model between modeling slip at the ice-bed interface and a meter down within the till.  Vertical resolution like this is only in the heads of process modelers.}

\reply{p.~4718, l.~21 q is already used for flux (even if printed in bold-face to identify its vector character).  I suggest using another variable name.}
{Exponent $q$ is used in prior literature, including \cite{AschwandenAdalgeirsdottirKhroulev}, and in the PISM users manual.\footnote{Despite the content of all reviews \dots oddly enough we are actually trying to publish a model description.}  There is consistent use of bold for vectors in the paper, thus the flux is $\mathbf{q}$ while the power is $q$, so no confusion will arise.}

\reply{p.~4718, l.~23 Previously (eq. 14), $v_b$ was the rate of basal motion. $u$ and $v_b$ are used inconsistently throughout the paper.}
{This has been corrected.  Only ``$\mathbf{v}_b$'' is used for the ice base sliding velocity, with ``$|\mathbf{v}_b|$'' for the sliding speed.}

\reply{p.~4719, l.~4 What value of $q$ have you selected for your simulations? Justification?}
{Value $q=0.25$ was used in the spinup that preceded the hydrology run \cite{AschwandenAdalgeirsdottirKhroulev}.  The sliding law equation (25) is, as stated above, included so that the reader knows that $\tau_c$ is a model output and how it is used, so the particular $q$ value is unimportant.  More important content, explaining the meaning of the $q=0$ and $q=1$ extremes, is given instead.}

\reply{p.~4720, l.~1  While ``velocity'' is technically correct, it is an odd choice for a thickness change. I suggest using ``rate.''}
{Sorry.  We mean that $\tilde{\mathbf{V}}$ is a velocity, not $\partial W/\partial t$.  This has been clarified.}

\reply{p.~4720, l.~5 Define $h$- the ice surface elevation.}
{This is simply a typo.  It should be $H$, the ice thickness.  Corrected.}

\reply{p.~4722, l.~7 ``\dots does not exist for tidewater glaciers or ice sheets.'' This may not be strictly true see Gulley et al, 2009, in QSR, where they report exploring many englacial conduits.  In subsequent work, Gulley has mapped subglacial conduits.  A safer statement would be that ``vapor/air-filled cavities are not known to exist far from glacier margins.''  The distinction regarding tidewater glaciers or ice sheets is unnecessary.}
{The relevant sentence has been removed in the revisions which shortened the paper.  As a general matter, however, we believe that vapor/air-filled cavities are not a feature well-supported by observations in a model intended for ice sheets.}

\reply{p.~4722, l.~10 ``observed in ice sheets and glaciers`` instead of ``observed in ice sheets''}
{We have clarified that we only mean ice sheets here by only citing Das 2008.}

\reply{p.~4722, l.~21 Add that the englacial water table is intended to represent the mean
over some large area of glacier, perhaps $>1$ km$^2$. Here, it is best to avoid the extreme
complications of, e.g., Fudge, 2008 in J Glac, where subglacial water pressures vary
significantly over very short distances.}
{Our point is not that there is variation over any particular scale, but that efficient connection to the subglacier implies a close connection between subglacial pressure and the height of water englacially.  This is not, fundamentally, contradicted by Fudge (2008).  We agree that our (notional) englacial water table represents a spatial-average of the nearly-unobservable englacial macroporous network.}

\reply{p.~4723, l.~8 You might add that we can expect phi to be large everywhere that $dP/dt$ would be large (a highly fractured temperate glacier in coastal Alaska), and that phi would be small only where $dP/dt$ is small (ice sheet interiors). Thus, even hydraulically/numerically ``stiff'' ice sheets shouldn’t experience physical or numerical shocks.}
{Actually, we think $dP/dt$ may be very large in ice sheet ``interiors'', namely during abrupt subglacial lake filling or drainage (observed in Antarctica) or moulin drainage of supraglacial lakes (observed in Greenland).  However, we don't really expect the model to be good for either highly-fractured temperate glaciers in Alaska, or for modeling the temporal or spatial detail associated to these ice sheet dramas.  Our point with englacial porosity regularization is that it eases the solution of a stiff problem.}

\reply{p.~4724, eq. 34 As before, are these m's supposed to be the same?}
{Yes.  See comment above.}

\reply{p.~4724, eq. 34 This is an odd combination of equations, because the top equation is a component of the bottom equation, but the middle equation has not been incorporated in the bottom equation.}
{Yes.  This is ``odd,'' but that is different from ``incorrect,'' and the situation is complicated by very important bounds (inequalities) on the conserved variables.  If the reviewer finds it incorrect (i.e.~deductively incorrect) he should say so.\\
\indent The context: As clearly stated in subsections 2.3 and 2.4, one can write either of two expressions for the flux, namely $\mathbf{q} = -K W \grad \psi$ or $\mathbf{q} = \mathbf{V} W - D \grad W$.  Also, a term $\nabla\cdot\mathbf{q}$ appears in both the water amount evolution equation and the pressure evolution equation.  The complications are that (i) we are indeed enforcing inequalities on $W,W_{til},P$, and (ii) we want to handle the $\nabla\cdot\mathbf{q}$ terms by the same numerics in both equations in which it appears.\\
\indent  In this context, the theory is made most clear, given that we don't want to write a paper using variational inequalities which would only be understandable to mathematicians, when we describe the numerical scheme in section 7.  After writing (and tossing) our paper several times with other expository choices, we find the current exposition most clear.}

\reply{p.~4726, l.~3 Note that this is essentially the same as eq. 27.}
{Yes.  This redundancy in the exposition has been removed.}

\reply{p.~4726, l.~23 Another connection is presented on p.~4721.}
{Yes, we have noted this connection now.}

\reply{p.~4727, l.~20 Around here, discuss that, in steady state, eq. 41 suggests that at water pressure decreases, the rate of basal motion increases. This flies in the face of most sliding laws. Can you offer any insight as to how we are to incorporate these two views in our understanding of hydrology and glacier dynamics?  Is the one-way coupling of your hydrology model with a glacier dynamics model sufficient to gain insight?}
{The reviewer has already made this comment above (page \pageref{inversepage}), and we address it there.  In summary, we are \emph{not} stating a sliding law and we \emph{are} stating correctly-deduced consequences of well-known and widely-used equations (esp.~equation (13) from \cite{Hewitt2011}).}

\reply{p.~4727, l.~20 Also note that $P$ depends also on $v_b$, not on $W$ alone.}
{Here $P$ depends on a lot of things, sorry.  Our notation ``$P(W)$'' emphasizes that one can write the equation as a function which yields $P$ given $W$, if all other symbols in the equation are defined.  This is the usual convention in more than a century of exposition in theories using mathematics.  A mathematician would presumably be equally-happy calling it ``$P(A,c_1,c_2,W_r,P_o,|\mathbf{v}_b|,W)$,'' so as to precisely state the dependencies, but probably not the reader.}

\reply{p.~4727, l.~23 I don’t see the relationship between eq. 41 and the $VW$ advective flux.  Please elaborate.}
{As noted immediately after this claim about equations (41) \emph{and} (38), we explain it in the Appendix.  It is nontrivial, so we explain it.}

\reply{p.~4729, l.~5 Readers should not have to turn to the appendix to learn what $s_b$ is. Move essential material out of the appendix and into the main text.}
{Good point.  As noted at the top of this document we have replaced section 6 by a brief text summary, in section 5.4, and so this issue with $s_b$ does not arise.}

\reply{p.~4729, l.~6 Defining this new $\omega_0$ variable seems unnecessary.}
{Yes.  The relevant text has been removed, and the issue does not arise.}

\reply{p.~4730, l.~5 What is the justification of the 5th power in the sliding speed?}
{In constructing an exact solution for the purpose of verification, specificity is essential, and qualitative reasonableness is of some importance, but uniqueness is not asserted or important.  Here the power used is simple (an integer) and implies smoothness (because the power on $|\mathbf{v}_b|$ is 1/3 in the formula $P(W)$, smoothness requires that this power exceed 3).  However, the reader is no longer bothered with the particular power because section 6 is replaced by a short text description of the construction of the nearly-exact solution.  Figures 2 and 3 remain, which show the solution.}

\reply{p.~4730, l.~17 Define what you mean by ``under'', ``normal'' and ``over'' pressure.}
{Yes.  We have added this into the text.}

\reply{p.~4731, l.~13 Give a few sentence introduction to the numerics here. The point is to
discretize eq. 34. What is the order of calculations? What will feed into what over the
next sub-sections of section 7? A thumbnail sketch similar to what is presented in 7.6
would be useful to guide the reader.}
{Our reordering of the exposition of the numerics now includes a brief introduction.  However, precision requires defining most symbols \emph{before} 7.6, where the important description of calculation order happens.}

\reply{p.~4731, l .19 Near here, is it necessary for a model development paper to include a
reference for ``CFL'' and ``upwind''}
{We have defined ``CFL'' in the revised version.  We believe that readers of this material will know what ``upwind,'' ``explicit'', ``finite difference'', ``centered,'' ``second-order,'' ``stability,'' and ``convergence'' mean, but in any case these are defined in the cited textbooks.}

\reply{p.~4731, l.~21 Be sure to clarify that $u$ and $v$ are not components of $v_b$, but are for the water speed.}
{Thanks for the reminder.  We have now defined $u,v$ components at their first use.}

\reply{p.~4732, l.~8 Parenthesis around the citation}
{Yes, got it.}

\reply{p.~4736, l.~7 Is it important that the reader understand what it means for a scheme to be ``flux-limited?''  Without modeling expertise myself, I’m not sure what this means.}
{Readers experienced with numerical advection schemes will know, but in any case the references to \cite{HundsdorferVerwer2010,LeVeque,MortonMayers} are adequate.}

\reply{p.~4742, l.~17 Because you report that your scheme is mass conserving so prominently
in the abstract, you should report how much error is involved with step (x), where
negative water thicknesses are discarded. This could be for the Greenland run of
section 9.2.}
{The quantity in question, the error in step (x), is bigger than we would like.  Quantitatively, in a run like the \texttt{distributed} run in section 9.2, the rate of loss of water from the subglacial hydrology into the ocean (esp.~at outlet glaciers) is about $300,000$ kg/s, the rate of loss of water onto ice-free land (i.e.~rivers and proglacial lakes) is about $1000$ kg/s, and the conservation error in step (x) is about $300$ kg/s. \\
\indent The size of this conservation error is a result of the implementation of the \emph{energy} conservation scheme at the ice base \cite{AschwandenBuelerKhroulevBlatter}, not the hydrology scheme itself.  Note that we only discard negative water thicknesses ($W_{i,j}^{l+1}<0$) when, essentially, the energy-conservation-computed basal melt rate $m$ is \emph{negative}, i.e.~in the refreeze case.  The size of the discarded negative thicknesses thus has to do with the magnitude and extent of large negative basal melt rates, and not the quality of the hydrology model at all.  The scheme itself is positivity-preserving. \\
\indent The size of this conservation error is thus not an issue in this model, but the fact that ours is the only paper which has ever even mentioned this quantity \emph{should} be at issue.  Noticing this error for the first time in a hydrology scheme is a feature not a bug.  Figuring out the best way to reduce it, and demonstrating its reduction to zero under grid refinement, are for future research.  But you have to notice it, or admit to it, before you can fix it.}

\reply{p.~4745, l.~22 Are the 2800 processor-hours on each of the 72 processors or divided amongst the processors?}
{It is the total number of processor-hours in the computation, as is standard in describing parallel computations and when using the units ``processor-hours''.}

\reply{p.~4746, l.~16 Do you specify a geothermal heat flux? The handling (or lack thereof) of geothermal heat should also be specified earlier, where the model setup is described.}
{We specify geothermal flux from input data to the model.  The relevant Shapiro and Fitzwoller data is addressed in the SeaRISE description paper \cite{Bindschadler2013SeaRISE}.  The ``handling of geothermal heat'' in PISM is documented carefully at full paper length \cite{AschwandenBuelerKhroulevBlatter}; it is nontrivial.}

\reply{p.~4746, l.~18 Please report if you identified any basal freeze-on ($m < 0$) consistent with Bell et al., 2014, Nat. Geosci., vol.~7?}
{Why this particular insistence?  As noted, we allow basal freeze-on.  Comparison to all existing observations is not the role of a model description paper.}

\reply{p.~4747, l.~25 Again, this is a good place to discuss the ramifications of a model without R-channels. What are the limitations of your model? Is there a way that aspects of R-channels emerge in your model without explicit channel modeling?}
{Yes, ``aspects of R-channels emerge \dots''.  We say, about the \texttt{routing} model, on page 4747, line 25 of the submitted text:
\begin{quote}
\emph{The continuum limit of the model would have concentrated pathways of a few meters to tens of meters width.  These concentrated pathways could be regarded as minimal ``conduit-like'' features of the subglacial hydrology.  As noted in the introduction, however, our model has no ``R-channel'' conduit mechanism, in which dissipation heating of the flowing water generates wall melt-back.}
\end{quote}
Similar text is in the revised version.}

\reply{p.~4748, l.~2 What about the eastern outlet glacier results makes them particularly
suspect? 7, C1774--C1781, 2014}
{They are suspect because of the quality of the ``bed elevation detail provided by the SeaRISE data set,'' as stated in the paper, given that the bed elevation field there is from few flight lines.  This sentence has been removed, however, and only a note that the bed elevation detail from SeaRISE is ``limited'' remains.}

\reply{p.~4748, l.~4 You report on the run time for your spin-up with the null hydrology model, but what are the processor demands for the distributed model described here?}
{Good point.  We have added the numbers, which are very small because we are not modeling ice dynamics, namely 14.2 processor hours for \texttt{distributed} and 14.7 for \texttt{routing}.  As noted, the higher modeled water velocities and modeled diffusivities in the \texttt{routing} model decrease the time step, which implies more computation, but on the other hand the per-time-step work in \texttt{routing} is less, so the computational times are very comparable.}
% 14.2286 proc.-hours
% 14.6556 proc.-hours

\reply{p.~4748, l.~5 Another statement regarding the sensitivity of results to $W_{til}^{max}$ would be useful here.}
{Though this model has a substantially-reduced number of parameters, relative to the model the reviewer would want, there are still far too many to examine sensitivity of all of these parameters.}

\reply{p.~4748, l.~20 Around here, worth mentioning that pressure as an increasing function of $W$ is vaguely in line with the results of the Flowers (2002) model, although your model reveals additional complexity.}
{We already make this connection at four different spots in the paper.  Additionally cluttering-up the description of our model results is, we believe, unnecessary.}

\reply{p.~4749, l.~17 ``seemingly-disparate''}
{Yes, thanks.}

\reply{p.~4750, l.~20 Again, reference the observation that steady pressure here increases as sliding decreases, which is inconsistent with almost all sliding laws.}
{As noted, we are not giving a sliding law, the inverse relation in question also applies to all the published models which have both cavity formation through sliding and cavity collapse through creep \cite[and others]{Hewitt2011,Schoofetal2012,Werderetal2013}, and this is not an important result of the paper.}

\reply{Table 3 Odd to present the melt rate as a function of water density. Change this to a
straight scalar (i.e., 200).}
{Yes. Table 3, and other details of the construction of the exact solution, have been removed, so the issue does not arise.}
\end{itemize}



\subsection*{Comments by Anonymous Referee \#2}\begin{itemize}
\reply{This paper describes a new sub-component of the open source ice-sheet model PISM,
which accounts for subglacial drainage of meltwater.  The model and a number of
subcases are described in considerable detail and then the numerical implementation
is described.  A simple steady state solution is used to test the numerical method, and
the model is then applied to the whole of the Greenland ice sheet.\\
\indent I enjoyed reading this paper.  It represents to my knowledge the first serious attempt
to include an evolving subglacial drainage model within an ice-sheet scale ice-sheet
model, and the results are encouraging.  As such, I would like to recommend publication.  However, I have a few issues that I think need to be clarified or thought about first.\\
\indent The major comments are here, followed by some specific but more minor points.}
{We appreciate this summary of the paper.}

\reply{1. The first term of (33), involving the pressure derivative and which represents
changes in englacial water content, ought to appear in (34a) also, since this term
derives from the mass flux into/out of the englacial system, and it is the addition
of this term to the mass conservation equation (34a) that gives rise to its appearance in (33).  As it stands in (34), subtraction of the first and third equations
puts the $\partial P/\partial t$ term into the opening/closure equation $\partial W/\partial t$, which I don't see justification for.}
{As we state, we only have \emph{notional} englacial porosity, because it is used as a regularization.  The fact that this pressure derivative term does \emph{not} appear in mass conservation equation (34a) is a reflection of the fact that we use englacial porosity only to cause the otherwise-elliptic pressure equation to become parabolic.  Actual englacial storage, which would enter into the conservation equation, would require another mass variable (e.g.~with notation ``$W_{eng}$'' as suggested by anonymous referee \#3) and then more coupling parameters between subsystems,\footnote{Both transfers between $W_{til}$ and $W_{eng}$ and transfers between $W$ and $W_{eng}$ would need to be parameterized.  We wrote such a model and paper and threw it away.} and more inequalities to deal with refreeze cases, would be required. \\
\indent The divergence of flux term $\Div\mathbf{q}$ appears in both the water thickness evolution and pressure evolution equations, in any model which has these three aspects: (i) mass conservation, (ii) cavity thickness evolution, and (iii) full cavities.  Such models appear in \cite{Hewitt2011,Hewittetal2012,Schoofetal2012,Werderetal2013}.  Thus we agree that ``subtraction \dots puts \dots into the opening/closure equation \dots'' is correct in our equations, and those in the just-cited work too.  Our use of this manipulation is correct even if the reviewer does not already do it, or think of it this way.\footnote{In fact our equation (32), which is verbatim from \cite{Schoofetal2012} in the till-free case, mixes opening/closing processes and the divergence of the flux, and so the same manipulation would put open/closing processes into the mass conservation equation in \cite{Schoofetal2012}.} \\
\indent In any case we cannot know what ``justification'' should be in the reviewer's head.  If the reviewer asserts our deduction is wrong here, or anywhere else, then he/she should say so.}

\reply{2. p4738, l11, and this section generally---is it clear that these arguments prove
stability for the \emph{system} of equations in this model (in which the coefficients in (60),
say are varying at each timestep due to the pressure evolution)? The analysis
here seems to be for a standard advection-diffusion equation on its own, but it
is not immediately clear to me that standard results can be used here. I have
no doubt that the method is stable, but I think if the stability properties are to be
discussed in this much detail, it needs to be done for the whole system together,
and not for the individual components of the operator splitting separately. Or if
there is an argument as to why this is sufficient, that should be included.}
{Yes, these arguments prove the stability of the numerical scheme for the particular equation in the presence of irregular coefficients which might come from coupling.  We are not using a linearized stability analysis here,\footnote{E.g.~von Neumann or Fourier analysis \cite{MortonMayers}.} an analysis which would ``break'' if the coupling is present, but a \emph{maximum principle} analysis.  Though it often gives overly-pessimistic stability conditions, one of the benefits of max principle analysis is that the details of the coefficients, including the possibility of them coming from coupling to other equations, don't enter into the analysis.\footnote{Thus the max principle analysis of stability of schemes for the three abstract heat-like PDEs $u_t=(1+x^2)u_{xx}$, $u_t=(1+u^2)u_{xx}$ and $u_t=(1+w^2)u_{xx}$, where $w$ is the solution of another equation, is the same if one wants sufficient conditions to ensure a maximum principle at each time step.  The \emph{positivity} of the coefficient is important here for the analysis to work at all, and its \emph{size} is important in determining a sufficient condition on the time step, but the \emph{origin} of the coefficient is irrelevant.}  We suppose that the reviewer has seen ``standard results'' for advection-diffusion equations which come from a linear stability analysis, as such results are closer to necessary and sufficient conditions in the constant-coefficient textbook cases.\\
\indent On the other hand, the case of negative source term, which in this case comes from outside the model (i.e.~through the energy-conservation-determined melt rate $m$ not through the involvement of coupled equations for $P$ and $W_{til}$), requires enforcing inequalities, and this is not in our stability analysis, as we state.  Furthermore, so as to shorten the paper we have removed the subsection in which the scheme is shown to have positivity-preserving and stable properties.  We have replaced this subsection with a brief text description.}

\reply{3. The boundary conditions should really be described in more detail.  It'd be helpful to state mathematically what boundary conditions are imposed (in section 5 say), rather than having it algorithmically described in section 7.  In particular, the diffusive nature of the $W$ equation suggests that one should apply some sort of conditions on $W$ at all boundaries, but these are rather hidden, \dots}
{On the one hand, the situation is much worse than portrayed by the reviewer, and it is not primarily about what is inside this paper.  On the other hand, there is no boundary in PISM in one of the senses meant by the reviewer.  We now explain these statements.\\
\indent Our model is, as clearly stated in the paper, subject to inequalities on water amount (i.e.~$W\ge 0$) and on pressure (i.e.~$0\le P \le P_o$).  These constraints imply that a mathematically rigorous description of the equations needs \emph{free} boundary conditions to be determined by a variational inequality or similar weak formulation.\\
\indent This is clearly understood \emph{for the pressure equation} by Schoof et al 2012 \cite{Schoofetal2012}.  However, \cite{Schoofetal2012} does not consider negative basal melt rate (i.e.~the case $m<0$ in equation (4.5) for the evolution of water thickness $h_w$ in \cite{Schoofetal2012}).  As a result they miss the fact that \emph{both} evolution equations, i.e.~for water amount $W$ and for pressure $P$ (our notation), are subject to variational inequalities.  Indeed, diffusive or otherwise, the continuum equation for water thickness $W$, as stated in \cite{Schoofetal2012} or \cite{Hewitt2011} or our manuscript or elsewhere, does not maintain positive values of $W$ if $m$ can be negative (i.e.~refreeze), so a free boundary appears which we must deal with.\footnote{It is a free boundary not seen in \cite{Schoofetal2012} primarily because there is no allowance for coupling to an energy-conserving basal melt rate, which would sometimes be negative.  In this sense the pre-determined water input of most subglacial hydrology modeling is addressing an easier problem than ours.}  Roughly-speaking, this free boundary delimits basins where ice streaming can occur.  A numerical scheme for $W$ evolution must actively enforce the inequality in some way, such as by restricting admissible functions or by truncation/projection in an explicit scheme.\footnote{Our scheme for mass conservation is explicit, but also the scheme in \cite{Schoofetal2012} is explicit.} \\
\indent Thus the only mathematically-honest treatment of our continuum model, or that in \cite{Schoofetal2012}, would require coupled variational inequalities.  As just one variational inequality is hard to handle---see \cite{Werderetal2013}, who say it is ``prohibitive'' in 2D and then skip it---the complications of a coupled pair are great.  We actually believe we \emph{are} correctly (i.e.~convergently) numerically solving this coupled pair of free boundary problems by an explicit scheme which truncates/projects to enforce the inequalities, but we are not close to proving that.  If we took on this topic with mathematical precision then (i) the paper would be enormous and (ii) no one would read it. \\
\indent On the other hand, note that the periodic domain (i.e.~flat torus) version of our model, or of the model in \cite{Schoofetal2012}, would have no classically-defined boundary conditions because the domain on which the continuum model is solved has no boundary.  For whole ice sheet simulations in PISM, the ocean or ice free land surrounding the ice sheet has exactly such a periodic extension, that is, no boundary.  This has little disadvantage in practice, and it allows the advantage that every grid point in PISM, on every processor, has the same physics.  We do state how all free boundaries are handled numerically---this is what we are doing ``algorithmically in section 7'', by stating where inequalities are enforced by truncation/projection---but we don't have classical boundaries at which to apply boundary conditions. \\
\indent In summary, we describe what the numerical scheme actually does in section 7.6.  Then we show verification results in a case where the exact continuum solution, subject to the two coupled (but unstated) variational inequalities, with free boundary, is known.  We think this is actually addressing the boundary conditions in a manner which is more helpful to the GMD reader than some more-mathematical expository alternatives.}

\reply{\dots and in section 9.1 it is claimed that there are convergence issues associated with a jump in $W$, which seems at odds with the diffusive term.}
{We have rewritten some text on how the boundaries in this model are really all free boundaries.  In particular, in section 5.1 where we summarize the continuum model, we explain that in ice-free land and ocean (i.e.~ice shelf or ice-free ocean) locations, the hydrology model sees such a large (in magnitude) negative value for $m$ that any water which flows to, or diffuses to, that location during a time step is immediately removed.  Thus we have a marginal jump in $W$ in the nearly-exact solution under consideration in section 9.1. \\
\indent The low regularity of the exact solution dominates the convergence rate, because the jump occurs along a non-grid-aligned curve.  (In polar coordinates one could do a 1D computation in which the jump is added as a grid point.  This would tell us nothing about the performance of our schemes in the presence of irregular source terms.)}

\reply{ \dots  I suspect the boundary conditions are mostly imposed by step (vi) on p4742, but I was not entirely clear on what is meant by 'not computing' the divided difference contribution to the flux divergence.}
{The sentence in question on step (vi) is simply wrong, and should not be there at all as it describes an old state of the code.  It has been removed.  \\
\indent Equation (55) is used as stated at all grid points, regardless of neighbor mask state.\footnote{See method \texttt{raw\_update\_W()} in file \texttt{PISMRoutingHydrology.cc} in branch \texttt{stable0.6} of the PISM source code.}  Thus the boundary conditions, which can all be interpreted as \emph{free} boundary conditions and which are motivated by concerns listed in replies above, are applied in steps (ii), (vii), (viii), (ix), and (x) in the list given in section 7.6. \\
\indent We have added the following ideas about boundary conditions to the revised text, in section 5.1, before going into detail about numerics: \emph{(i)} PISM always has a periodic grid for whole ice sheet computations, so there is no classical boundary to the hydrology system.  \emph{(ii)} Free boundaries occur all over the place as a result of enforcement of inequalities.  \emph{(iii)} In ice-free land and ocean (i.e.~ice shelf or ice-free ocean) grid points, the hydrology model effectively sees such a large (in magnitude) negative value for $m$ that any water which flows to, or diffuses to, that location during a time step is immediately removed.  \emph{(iv)} The ice-free land and ocean grid points have pressure determined by external factors (e.g.~atmospheric or ocean-base pressures).}

\reply{Finally, I felt the paper might be shortened without losing detail; there are a number of places where the discussion of relatively simple points is laboured. Sections that might be reduced include section 2.4, section 4.3, section 6.2, section 7.1, section 9.2.1, (could just reference Aschwanden et al for much of this?), section 9.2.4, and the appendix.}
{With this comment we heartily agree, and we have reduced length by 17\%.  Regarding the specific recommendations, we have shortened section 2.4, improved 4.3 without much reduction, removed almost all of section 6.2, but mostly-kept 7.1.  We have shortened 9.2.1 and 9.2.4, removed Figure 6, and emphasized \cite{AschwandenAdalgeirsdottirKhroulev} as a reference on our spinup procedure.  We have halved the length of the Appendix.  In addition we have made substantial reductions in section 5.2, we have removed sections 6.1 and 7.4 (replaced them by a sentence or two), and we have substantially shortened sections 7.2, 7.5, and 8.}

\reply{Specific comments\\
1. p4708, l3, also throughout - I do not see why the parabolic equation is always described as a 'regularization', which suggests some element of artifice.  For the physical system described, the equation is parabolic, and there is no need to treat it as a regularization.}
{The reason we call it a ``regularization'' is that we do \emph{not} have a conserved variable for englacial water amount, namely ``$W_{eng}$'' in the language of referee 3.  Whether or not the parabolization effect of the englacial term is a ``regularization'', our englacial model is thus not complete.  We use the englacial porosity coefficient as a way to make computations with our explicit scheme faster.  Because our pressure equation is parabolic, we can do explicit time-stepping and enforce, by truncation/projection, the  inequalities on all the state variables.  The reader is allowed to believe there is an element of artifice if she wants, but ``regularization'' is appropriate.}

\reply{2. p4708, l7 - I'd temper this by saying that till is 'sometimes' observed, as I don't think it is true that it is always observed.}
{Though all reviewers objected to our categorical language here, none offered counter examples.  Nonetheless we added an expected weasel word to the revised text.}

\reply{3. p4708, l20 - it is not the inclusion of wall melt in the mass conservation equation that leads to the instability but rather [the] inclusion of wall melt in the kinematic opening-closure equation.}
{In a model where the subglacial aquifer is always full (i.e.~``$W=Y$'' in our model), there is no distinction between these ideas.  The cavity volume is the mass, and both are conserved.  Thus the comment also applies to the ``normal pressure'' case in the model in \cite{Schoofetal2012,Werderetal2013}, for example.}

\reply{4. p4711, l9 - given the coupling with PISM, it seems a bit odd to say that you 'accept' the hydrostatic approximation, since you should be calculating $P_o$ consistently with the ice flow. As I understand it $P_o$ is always hydrostatic for the level of approximation in PISM, so this would seem a better justification.}
{It is perfectly reasonable, and clear, to describe this as ``accepting'' an approximation which we make just for our subglacial hydrology model.  Someone using a Stokes ice dynamics model could accept, or not accept, this simplification of the hydrology model.}

\reply{5. p4713, l11, also throughout - I find the repeated reference to the 'advection-diffusion equation' a bit misleading as although it has advection and diffusion terms, it is rather different from what is normally associated with that term, as the velocity depends on the pressure which is evolving simultaneously.  Perhaps this is my own connotation of advection-diffusion, but I think it should be emphasized that (12) is not stand-alone and is inherently coupled to more equations.}
{This is mystifying.  There is a large literature of numerical advection-diffusion equations, and \emph{all} of it implicitly or explicitly assumes that the numerical recommendations therein should apply both in uncoupled and coupled circumstances.  Nobody seriously models advection in a case where the velocity is given by God, though all textbooks start that way.  Of course motion comes from other, coupled equation(s). \\
\indent We agree that many \emph{proofs} of qualitative properties, or convergence of numerical schemes, only hold in the uncoupled case.  But good advice for constructing numerical schemes, coming from careful analysis in the uncoupled case, should be used when working numerically in the coupled case, unless there is a coupled analysis which is more informative.\footnote{What a nice thing to imagine!  I know of no examples.}  The point of this text, clearly made, is that the advection-diffusion separation allows us to carefully choose numerical schemes for the two terms in the mass conservation equation.  Since the same divergence of the same flux appears in the pressure evolution equation, we use the same numeric split there too.}

\reply{6. p4717 - the prescription of a minimum value for $N$ seems a bit arbitrary---could it be explained briefly what this physically represents? (e.g.~this is the level at which the till becomes sufficiently deformable that a cavity system is developed and that effectively caps the water pressure?) I would have thought a critical pressure, rather than a critical fraction of overburden, might be more reasonable? \dots}
{Broadly speaking, the reviewer seems to be saying that he/she does not have a plan for modeling the manner in which the effective pressure in the till should not reach full overburden pressure.  Note that till water pressure has been observed to not reach full overburden pressure in those boreholes through ice sheets which have been drilled to the base. \\
\indent We do have a plan, and we explain where it comes from (esp.~Tulaczyk), and derive specific equations because otherwise there is no model.  The manner in which this ``critical pressure'' arises is modeled nowhere in the literature of distributed subglacial hydrology systems, that we know of, and the reviewer offers no suggestions either.  But we have constructed a highly-simplified, very-few-parameters version which is supported, though indirectly, by comparing its results to observations at the surface of the ice \cite{AschwandenAdalgeirsdottirKhroulev}.}

\reply{\dots That aside, I found the prescription of $W_{til}^{max}$, and subsequent derivation of till thickness $\eta$ (22) rather odd, since it seems more natural to prescribe the thickness of till $\eta$ and have $W_{til}^{max}$ derived from that (and $\delta$ and $P_o$).  As it is, $\eta$ varies as the overburden varies (when coupled with ice flow), so that there is implicit redistribution of sediment.}
{We are actually quite clear that the pore void ratio and the water amount in the till are proportional; see equation (20).  We are then quite clear that, because we are enforcing inequalities on the conserved quantity $W_{til}$, we prefer to parameterize the maximum capacity of the till by a maximum water amount value.  It is trivial to choose to specify the till (mineral part) thickness instead of $W_{til}^{max}$, if the reader so desires. \\
\indent Whether or not the reviewer likes our way of parameterizing the lower bound on effective pressure, as scaling with the overburden, in fact equations (18) and (20), which come from in situ observations of till \cite{Tulaczyketal2000}, imply a relationship where $\eta$ varies as the minimum effective pressure varies.  Indeed, redistribution of till may be the way a minimum effective pressure arises. \\
\indent Again, our choice is not asserted to be wrong but ``rather odd'' and less ``natural''.  It is hard to argue against such criticism.}

\reply{7. p4721, (30) and following sentences - it is a bit confusing to write $P = P_{FC}(W)$ here (and in (29), and similarly in the appendix), as the formula depends upon $P_o$ and therefore space, as well as on $W$.  It'd be clearer to include $x$ as an additional argument here ((30) is not then a clean porous-medium equation).}
{Reviewer 1 wants us to emphasize that $P(W)$ in our steady state is actually $P(|\mathbf{v}_b|,W)$, and reviewer 2 wants us to replace $P_{FC}(W)$ with $P_{FC}(P_o,W)$.  But our notation for functional dependence is used in the normal way of applied mathematics. \\
\indent The reviewer believes the phrase ``clean porous-medium equation'' is reserved for the constant-coefficient case?  To avoid this, we have written ``generalizes the porous medium equation'' now, for the relevant equation.}

\reply{8. p4723, l5 - this sentence reads rather strangely.  Aren't most of the parameters 'user-adjustable'?  What is meant by temporal 'detail' in the pressure evolution - is it suggesting that $\phi_0=0$ is 'correct'?  Later that paragraph, what is meant by diffusive 'range', and would it not scale as $\phi_0^{1/2}$?}
{Most of the parameters in climate models are only barely user-adjustable; it is standard to require recompilation if there is a parameter change.  In PISM this is a runtime adjustment only, through either a command-line option or a configuration file. \\
\indent In any case, our point is that users of the model in computationally-challenging coupled circumstances (e.g.~high-resolution, ice-age-duration simulations of whole ice sheets coupled to GCMs) can choose to lose (i.e.~smooth out) temporal resolution in the model but thereby gain performance.  In other words, we are emphasizing that the \emph{tradeoff} is user adjustable, not just the parameter.  Emphasizing the ``user'' aspect of this is relevant.\\
\indent The ``correct'' value of $\phi_0$ is a silly concept; the macroporosity of the near-base parts of ice sheets is, and will remain, nearly unobservable.  This is one more reason why we call the way we include this parameter a ``regularization.''  We have removed the concept of ``diffusive range'' from that part of the text, as one of many shortenings.}

\reply{9. p4723, l16-22 - this algorithm is certainly a lot more computationally efficient than the method used to solve the elliptic variational problem of Schoof et al (2012), but it should be noted that the schemes are not solving exactly the same problem (at least, for non-steady states, which is where the computational cost lies).  Difficulties of Schoof et al's method stemmed notably from discontinuities in $W$ associated with unfilled cavities, which are absent in the current problem.}
{This is mystifying.  By no means do we assert that \cite{Schoofetal2012} is solving ``exactly the same'' time-dependent problem.  There are many points in the paper where we distinguish, most prominently: (i) We say in section 4.2 that we assume full cavities and there draw a contrast with \cite{Schoofetal2012}. (ii) We have a large section 4.3 on the englacial regularization, which clearly states that this is a change from \cite{Schoofetal2012}. (iii) We then say in 5.2 what specific changes would convert back to the \cite{Schoofetal2012} model.  \\
\indent Furthermore we don't say ``this algorithm is certainly a lot more computationally efficient than the method used to solve the elliptic variational problem of Schoof et al (2012).''  It would be tedious (read ``it would be a math paper'') to analyze the algorithms so as to perform this comparison, supposing we had enough detail from a 2D implementation of \cite{Schoofetal2012} to do so.  The comparison would involve the efficiency of the numerical choices used in solving the nonlinear elliptic problem in \cite{Schoofetal2012}, presumably including Newton solver and iterative linear algebra choices.\\
\indent  What we do show is an actual example at a much larger computational scale, not to mention in 2D, than offered in \cite{Schoofetal2012}.  However, the differences are from different continuum models \emph{and} different numerics.  Because the 2D implementation in \cite{Werderetal2013} does not actually bother with the elliptic variational problem of \cite{Schoofetal2012}, we can't compare apples to apples at all.}

\reply{10. p4727, l6 - I'm not sure how much we know that the system is close to steady state 'much of the time', so I'd recommend removing this; justification for looking at steady states is probably not required.}
{Thanks!  We have removed the wordy justification for looking at the steady state equations.}

\reply{11. p4728, l1 - clarify that this statement is for a given discharge?}
{This statement was justified by a specific argument in the Appendix, but the whole concern is to subtle.  We have removed the statement and its justification to save space.}

\reply{12. p4729, l11 - I am confused by the 'solution' $W = W_r$ to (45). This would only be a solution if the ice surface were a very particular shape?}
{The idea that the ODE in question had a constant solution, which was not clear relative to the statement of equation (45) anyway, has been removed as part of our major reduction of the description of the nearly-exact solution.}

\reply{13. Section 6.2 - the discussion of the boundary conditions here seems unnecessarily confusing and it could be much clearer just to state the shape, sliding velocity, and boundary conditions that are used, rather than explaining in generality how the solution works. Note that $W_c$ has only been defined in the appendix so comes out of the blue here. Since $r = L$ is the edge of the domain, the distinction between $L_-$ and $L$ seems pedantic (the definition of variables outside of the domain has not yet been given, and is more of an algorithmic issue).}
{Again, this text has been removed.  We agree it, and the material in the Appendix, were not well-factored.}

\reply{14. p4731, (48) - $\varphi_0$ is $\omega_0$ ?}
{Again, the relevant text, and the symbol $\omega_0$, have been removed.  (And the answer is ``yes''; it was a typo.)}

\reply{15. p4731, l7 - presumably the numerical value for $W^*$ given here corresponds to a particular parameter set? It must depend upon $k$, $H_0$ etc?}
{Yes, the numerical value of $W^*$ depended upon particular parameter values listed in Table 3.  But the text in this section 6.2, and Table 3, have been removed.  The nearly-exact solution is described in words and then pictured in Figures 2 and 3.}

\reply{16. p4736, l20 - the right hand column here seems unnecessary?}
{Yes.  We have simplified these equations by removing the right-hand column.}

\reply{17. p4739, l25 - The numerical values of timesteps here and on p4732 could be brought together to save space and avoid repetition. The value of $\phi_0$ used seems rather large; if a smaller value were used (going towards the elliptic limit) might the timestep restriction become restrictive?}
{The time step restrictions have been brought together, as suggested, in the revised text. \\
\indent  We agree the value of $\phi_0$ is rather large.  A smaller time step would cause more expensive computations, which is exactly the point made earlier about the ``user-adjustable tradeoff''.  In the text in question, our point becomes stronger with a smaller value of $\phi_0$: the time-step for the pressure equation is controlling for the coupled scheme.}

\reply{18. p4748, l15, and figure 11 - I was a bit confused by the comparison of $W$ and $P/P_o$; what significance is $P/P_o$ believed to have? Doesn't a lot of this information come just from the steady state relationship between $W$ and $P$ in (A4)?, The caption is a bit confusing when it refers to 'pairs' $(W,P)$, but what is plotted is really $P/P_o$.}
{Yes, a lot of the information comes from formula (A4), but we want to \emph{show it}, not just state it.  Showing a figure with various cases makes the multi-parameter dependence in (A4) clearer to the reader, we believe.\\
\indent  Because $P$ is always bounded above by $P_o$, and because creep closure of cavities is a function of the difference $N=P_o-P$, we want to clearly show areas which are close to overburden.  Because the thickness of the Greenland ice sheet, and thus $P_o$, is highly variable on our 2km grid, the easiest way to show the areas where the pressure is close to overburden is to show $P/P_o$.  We have fixed the caption to refer to $(W,P/P_o)$ pairs.}

\reply{19. p4749, l9 - what is the 'actual diffusivity of the advective flux'?  'diffusive nature of the advective flux' might be clearer.}
{Yes, that is a better rewording, and we now use it.}

\reply{20. p4749, l15 - this statement is rather vague, and I'm not sure what it's trying to say.}
{We have simplified and improved the relevant text.  In particular, the two-item un-numbered list on lines 14--19 of page 4749 has become the following single sentence: ``The reasonably-comprehensive exposition here also clarifies the relationship among several pressure-determining ``closures'' (section 4), and it allows us to understand our model as a common extension of several seemingly-disparate published models (section 5).''}

\reply{21. p4751, l17 - something missing from this sentence?}
{Right.  It should not have ``is that''.  The totally-rewritten sentence now says ``In any case, in the current paper we do not impose a relationship $P=P(W)$ at all, though such a relation emerges in steady state.''}
\end{itemize}


\subsection*{Comments by Anonymous Referee \#3}\begin{itemize}
\reply{\textbf{Summary of the manuscript}\\
The manuscript (MS) describes a novel subglacial hydrology model implemented as
part of the PISM ice sheet model. To my knowledge, this model together with the
model of de Fleurian et al. (2014) (Elmer/Ice) are the currently most complex hydrology
models included in large scale ice sheet models. The hydrology model consists of a
cavity-like layer which can conduct the water horizontally, and two storage components:
a till layer and an englacial aquifer. The coupling to ice flow would be through the yield
strength of the till, which in terms [sic; ``turn''?] depends on the amount of water stored (although no
two-way coupled runs are demonstrated). The model performs well on test cases with
analytic solutions and on an application to the Greenland ice sheet.\\
\indent The MS is very detailed and describes the mathematical model, some analytic solutions, the numerical implementation and some test applications. The MS is suitable for
publication in GMD after the comments below are addressed.}
{We appreciate this summary but want to make some comments. \\
\indent While the de Fleurian et al. (2014) \cite{deFleurianetal2014} model is included in the ice sheet model Elmer/Ice there is no evidence whatsoever that it applies at ``large scale'' as implied by the reviewer.  The paper \cite{deFleurianetal2014} itself applies it only to a single mountain glacier, and does not give an estimate of the number of degrees of freedom in the hydrological system; we suspect it is more than an order of magnitude less than in our application.\footnote{Scale is not everything, and the application in \cite{deFleurianetal2014} may be a very good one.  But not ``large scale''.} \\
\indent Next, we do not have ``englacial storage,'' although this is clearly desired by the reviewer (below).  As our manuscript states in a variety of ways, we use the regularization effect of an englacial network to make the pressure equation better behaved, but we do not have conserved degrees of freedom describing the englacial water, which would be ``$W_{eng}$'' in the reviewer's notation.  Thus we do not have as large a space of unknown transfer coefficients as would such a theory.}

\reply{\textbf{Mathematical model}\\
My main comments are that water in englacial storage is not accounted for, that the statements $0 \le P \le P_o$ and $W = Y$ are inconsistent, and that boundary conditions are omitted. Further, in the mathematical sections it is never explained how in detail the bounds on P and also W till are enforced, although it can be deciphered from the later sections on numerical implementation. Also the authors mention that their pressure regularisation is necessary to allow enforcing $0 \le P \le P_o$ (by projection).  Why is this so? Why could this not be done using the elliptic pressure equation?}
{Yes, the water in englacial storage is not in the model, thus not accounted-for. \\
\indent The statement $P\le P_o$ and $W=Y$ are of course consistent, and also apply to the model \cite{Schoofetal2012}, so we presume that the concern is with the combination $0\le P$ and $W=Y$.  In this case, what does ``inconsistent'' mean?  Inconsistent with a physical principle---none is named---or not well-posed in combination with the other equations---we disagree---or just inconsistent with the imagery in \cite{Schoofetal2012}?  In any case, it is hard to respond to this vague claim.\\
\indent We have attempted to improve, and bring earlier, the presentation of boundary conditions.  In particular, we note the inequality $W\ge 0$ which implies additional free boundaries not addressed in the literature.  We handle such free boundaries, and the ones which arise from enforcement of pressure bounds, by a common, documented scheme.\\
\indent We never assert ``pressure regularisation is necessary to allow enforcing $0 \le P \le P_o$ (by projection)''.  Rather, we enforce these inequalities on the solution of a regularized (thus parabolic) version of the unregularized (elliptic) equation in \cite{Schoofetal2012}.  These same inequalities are enforced in \cite{Schoofetal2012} for that elliptic equation, by restricting admissible functions in a variational inequality formulation.  The enforcement of inequalities is thus an independent issue from regularization.}

\reply{Mass conservation (Eq. 1, 34a) should also take into account $W_{eng}$, the equivalent layer of water stored englacially:
   $$\frac{\partial W}{\partial t} + \frac{\partial W_{till}}{\partial t} + \frac{\partial W_{eng}}{\partial t} + \nabla \cdot \mathbf{q} = m /\rho_w. \qquad (1)$$
In particular, for the void ratios ($\phi_0 = 0.01$) considered in this MS the $W_{eff}$ [sic; presumably ``$W_{eng}$''] term is important.  For instance, a relatively small pressure difference of 10 m water head leads to a change in $W_{eff}$ of $0.1 m$ which is on the order of $W$. In fact, having $\phi_0 = 0.01$ is probably beyond what may be considered a regularisation (i.e. having negligible effect on the solution), and the MS should be updated accordingly.}
{In our model the conserved mass is $W+W_{til}$, not $W+W_{til}+W_{eng}$, as desired by the reviewer.  This reduces the number of parameters and inequalities to which the solution is subjected.  Instead we only use the parabolicization effect of englacial porosity to make the pressure equation less stiff.  This is very clearly-stated in the paper.}

\reply{If possible, it would be nice to state the bounds on the various state equations more explicitly, e.g.:
  $$\frac{\partial W_{till}}{\partial t} = \begin{cases} m /\rho_w - C_d & \text{if \dots} \\  0 & \text{otherwise}  \end{cases} \qquad (2)$$
Or if that is not possible, state the bounds next to the equations.}
{This is a good point.  We now state the bounds immediately after the evolution equation.}

\reply{For the pressure, according to the numerics outlined in section 7.6, the authors solve Eq.33 on the whole domain for $P$ and then project/update P such that $0 \le P \le P_o$ (except where $W = 0$ also $P = P_o$ ).  Therefore $Y = P$ [huh?; sic; presumably ``$Y=W$''?] is only true in the so-called ''normal-pressure'' regions, which should be stated. In the overpressure or underpressure regions the authors instead use the mathematical closures $P = P_o$ and $P = 0$, which should also be stated.  Also, it seems that the pressure equation is solved for the whole domain using boundary conditions at the edge of the domain, which is in contrast to Schoof et al. (2012). This difference needs to be discussed in a section about boundary conditions.}
{We are not quite sure how to respond to this comment, which seems to ignor what we have written and instead be a re-argument for the model in Schoof et al.~(2012) \cite{Schoofetal2012}, which has never been implemented in 2D.  In summary, our cavities are full ($Y=W$), our pressure has bounds ($0\le P \le P_o$), and we believe our model is well-posed and correctly implemented, and the reviewer seems not to be pointing to any evidence to the contrary. \\
\indent We have improved our text in one related way, namely clearly defining ``underpressure'' as $P=0$ and ``overpressure'' as $P= P_o$ at the first use of these phrases to describe our model results.  The underpressure and overpressure regions in the model results are not using new closures as stated by the reviewer.  The closure is still ``$Y=W$'' but the continuum model includes the inequalities.   Where there is no water ($W=0$) we set either $P=0$ or $P=P_o$---we have clarified this---so as to determine pressure gradients at boundaries numerically, but this is not a ``closure'', as the water in such locations is absent.}

\reply{Even apart from the storage term (which the authors acknowledge), the presented scheme is not quite equivalent to the one in Schoof et al. (2012): To determine the regions where pressure equation needs to be solved (Eq.34c in this MS) Schoof et al. (2012) uses constraints on $W$ and not on $P$ (see their equations 4.1, 4.7 and 4.11).  In the region where the pressure equation is solved, Schoof et al. (2012) uses appropriate boundary condition to link to the adjacent regions.  Also in underpressure regions
Schoof et al. (2012) solve both for $Y$ and $W$ (their $h$ and $h_w$).}
{As we write above in reply to the previous reviewer, by no means do we assert that Schoof et al. (2012) \cite{Schoofetal2012} is solving an ``equivalent'' model.  There are many points in the paper where we distinguish, most prominently: (i) We say in section 4.2 that we assume full cavities and there draw a contrast with \cite{Schoofetal2012}. (ii) We have a large section 4.3 on the englacial regularization, which clearly states that this is a change from \cite{Schoofetal2012}. (iii) We then say in 5.2 what specific changes would convert back to the \cite{Schoofetal2012} model. \\
\indent The reviewer is actually wrong, however, that ``Schoof et al. (2012) uses constraints on $W$ and not on $P$''.  It is very clear in \cite{Schoofetal2012} that constraints on $P$ are used to define the convex space of admissible functions on which the variational inequality acts, and $W$ only plays the role of an input into the resulting weak problem.  In this sense our model is more like \cite{Schoofetal2012} than portrayed by the reviewer. \\
\indent In any case a 2D version of the \cite{Schoofetal2012} is not solved by the numerical work which those authors actually pursued, i.e.~in \cite{Werderetal2013}, because they were apparently unable to do so.  Indeed our $Y=W$ assumption is exactly as in \cite{Werderetal2013}, but in this case we \emph{do} enforce the pressure bounds that are used in \cite{Schoofetal2012}.}

\reply{To illustrate the impact of the different models, here [is] a pathological case which (I think) the mathematical model of Schoof et al. (2012) handles fine but the one in this MS less so: \\
\indent Starting with an initial, steady state with a region where $W > W_r$ and $P = P_o$.  Decrease input into that region until $P < P_o$, i.e.~something like a draining subglacial lake.  Now (as far as I understand the equations in the MS) $W$ in that region would evolve according to Eq.13, i.e.~shrink by viscous creep (unless $P < 0$ at which point it would again evolve according to Eq.34a). This contrasts to Schoof et al. (2012) which keeps $P = P_o$ until $W \le W_r$.}
{Ice creep is sensitive to stress (i.e.~pressure differences in this case) not whether the ice is in contact with water.  Thus we say \emph{yes}: once $P<P_o$ then the cavities \emph{should} start to close even if the cavity height is greater than the roughness scale $W_r$.  Indeed, none of the models in the literature tie the creep closure rate to the roughness scale.  In the absence of other factors, which relate to horizontal gradients in hydraulic potential, and to water inputs, this will have the effect of driving the pressure back up to $P_o$.  \\
\indent  We think the reviewer wants instantaneous action at a distance, a property of the \cite{Schoofetal2012} model, to instantly set $P$ to $P_o$ in this $W>W_r$ case.\footnote{This is the way differential-algebraic systems like \cite{Schoofetal2012} work.  We point out in the paper the numerical difficulties of differential-algebraic systems, but one could also note the physical undesirability of pressure ``wave'' propagation at infinite speed.}   All that the reviewer actually is saying, as far as we can tell, is that $P<P_o$ and $W>W_r$ would violate the equations in \cite{Schoofetal2012}, which we are not even sure is actually true. \\
\indent We are not asserting that our model is equivalent to \cite{Schoofetal2012}.  We think that this ``pathological case'' may even make our model look better as it does sensible things to initial states which would, apparently, be rejected in \cite{Schoofetal2012}.  We think we do roughly the same thing to this initial state that would occur in the model of Werder et al (2013) \cite{Werderetal2013}.}

\reply{Not getting this and other corner cases right is not bad and still results in a great
subglacial hydrology model, in particular for the application intended here. However,
Schoof et al. (2012) gets them right(er) (as far as I understand) and thus the authors'
claims that they successfully solve that problem should be a bit more qualified (see
line-comments below).}
{As above, we can disagree that we get this corner case wrong.\\
\indent We don't claim to ``successfully solve'' the model in \cite{Schoofetal2012}.  We do claim that our model is a ``common generalization'' of four models, of which \cite{Schoofetal2012} is one, and we precisely clarify what we mean by this phrase.  But readers do not expect that changed equations give the same solutions.}

\reply{Other comments\\
The manuscript is quite lengthy and could do with some streamlining. Among others,
Section 4.1 and 5.2 should be merged, Section 9.2.1 should be shortened and Fig.~6
removed.}
{We agree that the manuscript should be shortened, and we have done so.  However, merging 4.1 and 5.2 is undesirable because our explanation of what closure we \emph{put in} to the model (section 4) is very different from our text on what behavior \emph{appears from} our relatively-comprehensive model (subsections 5.2 and 5.3).  Section 9.2.1 has been shortened, and Figure 6 has been removed, as suggested.}

\reply{It would help if the authors would state the unknown variables at the beginning of the mathematical description.}
{This will be greatly helped by the placement of Table 2 in the published version (if that happens).  We have moved the first mention of Tables 1 and 2 to the start of section 2.}

\reply{The authors mention frozen conditions but never go into details about them.  What
happens to the cavity sheet and till layer when input is negative?  What does the water
pressure do?  What do the cavities and thus $W$ do?  In fact, the evolution equation for
$Y$ does not contain a melt/freeze term so $Y > 0$ even when frozen.  How does this link
to setting $P = P_o$ when $W = 0$ (p.4742 l.4).  This should warrant at least a paragraph.}
{``Frozen conditions'' can only be handled by considering conservation of energy.  We (appropriately) cite \cite{AschwandenBuelerKhroulevBlatter} for the two-phase conservation of energy model in PISM, which, in particular, determines the basal melt rate under an ice sheet.  We furthermore note that, unlike other work, can handle a negative basal melt rate and thus we must actively enforce $W\ge 0$ for the distributed system water thickness.  \\
\indent In summary, there is no separate thermodynamic variable for the temperature of the till.  Since the till (i.e.~not cavities) makes up the vast majority of the base of the ice sheet, by area, adding such a variable would be the primary way in which the model could made more complicated and physical.  The equations we present for hydrology modeling are independent of thermodynamics except through their dependence on the (signed) value of the melt rate $m$ and the meaning of the inequalities $W\ge 0$ and $W_{til}\ge 0$.  Our formula for till yield stress implies that un-saturated till (i.e.~with small values of $W_{til}$) is quite strong; this is the content of the model in \cite{Tulaczyketal2000}, which we cite.  We believe we have already supplied adequate information on these points to the reader in the revised text.}

\reply{\textbf{Comments by page and line number} (add 4700 to the page number):\\
\indent p.6 l.8 State how many parameters are used}
{Other papers do not do this.  We will not either, because the number of parameters can be made small or large by deciding on the meaning of ``parameter''.\footnote{Is the acceleration of gravity a parameter?  It is adjustable in PISM, because Mars ice models are encouraged, but \cite{deFleurianetal2014} does not list it as a parameter with a value while \cite{Werderetal2013} does.  In our paper symbols ``$e_0$'' and ``$C_c$'' appear, but only their ratio $e_0/C_c$ appears in our actual model (and in \cite{Tulaczyketal2000}); do we count this observation-based value as one parameter or two?}  We prefer that the reader see Table 1, which can be compared to similar tables in other papers, if the reader wants a sense of the relative number of parameters between models.\\
\indent Far more relevant than the number requested here is the content of section 5.2, where we show that by setting particular parameters to particular values we get specific published reduced models.  This gives a reader a clear, practical sense of the ``number of parameters.''}

\reply{p.6 l.8 Instead of ``We use englacial porosity as a regularization, and we preserve
physical bounds on the pressure.'' write ``We use englacial porosity as a regularization to impose physical bounds on the pressure.''  But in fact, I am not sure this statement is right, as bounds on the pressure are enforced by projecting it onto $0 \le P \le P_o$.}
{In fact we do \emph{not} use ``englacial porosity as a regularization to impose physical bounds on the pressure''.  We have changed the relevant sentence in the abstract to say simply ``We preserve physical bounds on the pressure.''  The separate technical fact that we have regularized the elliptic variational inequality model of \cite{Schoofetal2012} to a parabolic model, using notional englacial porosity as a regularization constant, is now not mentioned in the abstract, though it is fleshed-out and clear in the text.  The reviewer gets to the correct fact---in our explicit scheme the bounds on pressure are enforced by projecting---and we have made this clearer in the revised text.}

\reply{p.6 l.21 reword ``reasonable''}
{We have written ``Any continuum-physics-based dynamical model'' to replace ``Any reasonable dynamical model''.}

\reply{p.8 l.4-6 This is not quite right, see my Section above.}
{The sentence in question \emph{is} quite right.  It is simply true that ``The subglacial water pressure solves an equation which is a parabolic regularization of the distributed pressure equation given in elliptic variational inequality form by \cite{Schoofetal2012}.''  Compare equations (32) and (33) in the till-free case.}

\reply{p.8 l.19-24 Maybe this paragraph should be moved to start at line 7.}
{We have done so.}

\reply{p.8 l.29 Whilst no mathematical proven [sic; ``proof''] of convergence of grid-based models is available,  they do seem to converge under grid refinement in a statistical sense (see appendix of Werder et al. (2013)).  Also, their parameters are independent of the grid.  Thus automatic grid-resolution determination should be possible.}
{The Appendix of \cite{Werderetal2013} in question is wrong.  It contains only evidence for the opposite of what it attempts to sell. \\
\indent It is started by the correct sentence ``The solution produced by a numerical scheme for solving partial differential equations should converge to the true solution under mesh refinement.''  The second sentence is ``However, for the presented model convergence in this sense will not be satisfied as the mesh forms part of the solution by restricting potential channel locations \dots''  Now that there is no PDE, we don't know what they are looking for as ``convergence;'' no meaning of that word is given though it is then used.  \\
\indent Indeed, they show next that they have \emph{not} made progress toward a PDE because their evidence shows their model \emph{does not} converge as would a solution to a PDE, even statistically.  Their figure of results (Figure A1) shows that as the mesh distance decreases, and so the number of channels increases, the maximal discharge of any channel converges to around 100 $\text{m}^3/\text{s}$, the level against which they then report a ``convergence rate'' of ``$O(\Delta x^2)$''. \\
\indent But convergence of edge fluxes to a non-zero amount is not a property of a numerical solution of a 2D PDE model.  When the number of mesh edges increases, in such a model in which fluxes are along edges, the maximum flux must decrease to zero.  Specifically, for a 2D, flux-conservation PDE problem solved by a structured-grid method as here, the number of edges crossing a fixed line\footnote{I.e.~``at $x=$ 5km''.} is proportional to $1/\Delta x$ as $\Delta x\to 0$.  The total flux across that line should converge to whatever amount is given by the continuum solution, so the flux through each edge should converge \emph{to zero} at rate $O(\Delta x)$.\footnote{If the PDE solution is irregular then the maximum flux though any edge might converge at an even slower rate like $O(\Delta x^{1/2})$, but if it does not converge to zero then there is no PDE solution.}  The evidence given is actually adequate to make this statement: The parameters in the model do not currently scale so as to generate a PDE limit. \\
\indent Thus we are in a bad situation, made worse by additional text in the same Appendix and now by the reviewer's assertions.  First, the final sentence of the Appendix is an evidence-free claim of prospective performance: ``This variability should decrease further once real topography is used and is unlikely to be larger than the errors of field measurements.''  Second, the reviewer now implies that what is missing from \cite{Werderetal2013} is merely a proof of convergence,\footnote{``Whilst no mathematical proven of convergence \dots''} but this is apparently only indirection; we never come \emph{close} to saying it was a lack of a ``proof'' of convergence that caused us to not implement conduits.  Third, the claim by the reviewer of additional prospective ``automatic'' numerical performance, without evidence, is unfortunate given the available evidence. \\
\indent Reviewers \# 1 and \# 3 want us to buy into this idea of using a 2D lattice model of conduits in a scalable ice sheet model, and the only offered evidence of this even being possible, \emph{much less the right modeling choice for a model to be applied at every point of an ice sheet}, is actually evidence for the opposite view.}

\reply{p.9 l.8 ``closures'' here and elsewhere can be confused with ``creep closure,'' reword.}
{While we don't think this is a likely reader confusion, we have put quotes around ``closure'' here, so that the reader looks to the referenced section 4 for the meaning of the word.}

\reply{p.9 l.19 It would help to briefly introduce which processes will be described and in
particular which are the unknown variables (or major variables as the authors call
them later).}
{We have moved the first mention of Table 2, which categorizes major variables into ``state'', ``input'', and ``output,'' forward to this point.  The introduction states what processes are involved.}

\reply{p.10 Eq.1 add a term $\partial W_{eng}/\partial t$}
{No.  As noted, we do not conserve water held englacially.}

\reply{p.10 l.9 it is not quite clear what ``the two-dimensional subglacial layer'' is. Presumably it is the layer which has thickness $W$.}
{We model the base of the glacier as a two-dimensional surface.  Furthermore, in common with the literature, we have a \emph{thickness} for subglacial water, which makes the model two-dimensional.  The conserved quantity $W+W_{til}$ is a thickness, the flux follows the ice base (instead of going into the ice or into the ground), and the equations for all variables only involve $x$ and $y$ derivatives; these are all the usual meanings of ``two-dimensional''.}

\reply{p.10 l.18 Specify that the pressure $P$ is at the top of the water layer too.}
{No.  This is not what we mean, nor what is meant by the pressure variable in other literature (e.g.~$p_w$ in equation (1) of \cite{Werderetal2013}).  In such 2D pressure equation models one can regard the pressure variable as a vertical average of the pressure, but note it does not increase with thickening of the layer alone, which it would if it had the meaning implied by the reviewer.  This is why we add ``$\rho_w g W$'' to our formula for the hydraulic potential, because (in common with all the literature) we have no vertical profile of pressure in the distributed system, but (not in common with the literature) we want subglacial lakes to spread-out as they physically would.}

\reply{p.16 l.8 write ``and $N_{til} = P_o-P_{til}$ is the effective pressure of the overlying ice on the saturated till \dots''}
{We don't feel we need to introduce the new symbol $P_{til}$ only to eliminate it in this way.  The cited literature adequately defines the phrase ``the effective pressure of the overlying ice on the saturated till.''}

\reply{p.16 l.10 Should be ``previous section'' but specify section number instead.}
{Yes.  Fixed.}

\reply{p.16 l.19 I find $N_0$ confusing. The very similar looking subscript ``o'' in $P_o$ refers overburden but the ``$0$'' is something else. Maybe $N_r$ or $N_{ref}$?}
{We do not use symbol ``$N_o$'' or other things that could be confused.  We are using here the notation from \cite{Tulaczyketal2000}, and we would like to keep that correspondence.}

\reply{p.17 l.8-16 What follows in this part is unclear. Reformulate of [sic] this introductory sentence ``On the other hand we will describe the maximum capacity of the till by specifying \dots'' to prepare the reader that instead of working with $\delta$ you change to $W_{til}^{max}$.}
{The sentence in question now says ``On the other hand we specify a maximum $W_{til}^{max}$ on the water layer thickness, \dots'', to bring forward the symbol $W_{til}^{max}$.}

\reply{p.17 l.10 Should this not just be $W_{til} < W_{til}^{max}$.  The lower bound is never used, or is it?}
{The lower bound $0\le W_{til}$ is most-certainly used.  We observe that almost all of the literature, in situations like this, fails to note this inequality.  In fact, if the source terms can be negative in a mass conservation equation for which the conserved variable is a \emph{thickness} then the model must actively enforce the fact that the thickness is nonnegative.  Within our paper we have also made this is made clearer with respect to the thickness $W_{til}$.}

\reply{p.19 l.10 For this section the $Y$ equation is not needed/decoupled. That should be
mentioned.}
{This is precisely what the sentence on lines 11--12 says: ``We first consider two simple closures which appear in the literature but which do not use cavity evolution Eq.~(13) or similar physics.''  Equation (13) is the $\partial Y/\partial t$ equation.}

\reply{p.20 l.22 comma after ``consider.''}
{The sentence in question now says ``At an almost opposite extreme, our second simplified closure makes the water pressure a function of the amount of water.''  This avoids the issue.}

\reply{p.22 l.10 Expand here (or maybe elsewhere) on how $P \le P_o$ is enforced.}
{We now state how this inequality is enforced in both sections 5.1 and 6.5 (new numbering).}

\reply{p.23 l.15-22 This paragraph is a bit misplaced in this section.  Maybe the enforcement of the various constraints, including $0 \le P \le P_o$, warrants its own section.  Which is where this paragraph would belong.}
{This paragraph belongs here because explicit time-stepping is only possible in equations without algebraic constraints.  That is, only after we state our regularized pressure evolution equation can we make a basic point: because of the $\partial P/\partial t$ term in our equation, a time-stepping solution \emph{can} be explicit.  Now we don't have to follow \cite{Schoofetal2012} and use an elliptic variational inequality form to incorporate the bounds $0\le P \le P_o$.\footnote{We could follow \cite{Schoofetal2012} in this respect, but we have an easier-to-implement option which is numerically consistent and (we believe) convergent.}  This paragraph, and the following paragraph about Clarke's model, are indeed about consequences and meaning of the englacial porosity regularization.}

\reply{p.23 l.19-22 These two sentences suggest that the authors have solved the ``prohibitively expensive'' problem of Werder et al. (2013).  But as discussed above, they only solve a simplified version of Schoof et al. (2012) without channels.  Reword.}
{The reviewer is not paying attention to what Werder et al.~(2013) \cite{Werderetal2013} actually says:
\smallskip
\begin{quote}
\emph{Note that we impose no restrictions on the values that the water pressure can attain. This is in contrast to the model in Schoof et al. [2012] and Hewitt et al. [2012] which assumes that an air/vapor gap forms when the pressure drops to zero, and instantaneous ice uplift occurs when pressure exceeds overburden. However, the numerical procedure used in those studies is prohibitively expensive to use in 2-D.}
\end{quote}
This makes it copiously clear that it is the ``numerical procedure used in those studies'', including in Schoof et al.~(2012) which has no conduits, which is expensive.  And that it is is a numerical procedure to ``impose \dots restrictions on the values that the water pressure can attain.''  We have indeed offered an alternative, and demonstrated without question that it ours is not ``prohibitively expensive''.\\
\indent The reviewer claims this issue is about ``channels'' (conduits).  It isn't.  We stand by what we said, ``This variational inequality problem is asserted to be 'prohibitively expensive' by Werder et al.~(2013) when solved in two dimensions at each step of a time-stepping model.''.}

\reply{p.24 Sec.5.1 I like this summary. One suggestion: write the equations in Eq.34 all as
``time derivative of unknown = something.'' Add the boundary conditions.}
{We have added text about boundary conditions to subsection 5.1.\\
\indent However, we do not take the suggestion that we write as ``time derivative \dots = something'' for a well-known reason.  When there are constraints, ODE systems are often written
    $$M\frac{d\mathbf{u}}{dt} = A \mathbf{u}$$
and not
    $$\frac{d\mathbf{u}}{dt} = M^{-1} A \mathbf{u},$$
even when $M$ is invertible.  The reasons are subtle, but they apply here: we want the minimum well-posed statement of evolution in a model in which there are constraints on the variables.  In our case our system is PDEs, but (appropriately-interpreted) our $M$ is triangular and invertible.  It ceases to be invertible as $\phi_0\to 0$, as we state in comparing our model to that of \cite{Schoofetal2012}, which has a differential-algebraic version of our problem.}

\reply{p.25 l.1-8 Either be specific about which functions are what type or leave the paragraph away.}
{Table 2 makes it copiously clear which functions are of which type.  We have pointed the reader to that Table earlier in the paragraph.  This paragraph is key for explaining coupling to ice dynamics.}

\reply{p.25 Sec.5.2 This section should be merged with section 4.1, probably at this location in the MS.}
{We believe that the existing structure of sections 2--5 is very important in this regard. \\
\indent In sections 2 and 3 we point out physical principles with which readers will not disagree.\footnote{I.e.~disagree fundamentally.  Details are subject to disagreement, of course.}  Then we start section 4 with the key statement ``The evolution equations listed so far \dots can be simplified to three equations in the four major variables \dots  We do not yet know how to compute the water pressure $P$ \dots''  Subsection 4.1 then collects closures which are for this purpose (i.e.~determining the water pressure) but which are scattered all over the literature.  Only with this structure can we \emph{then} make clear why our choice (i.e.~simply $W=Y$) is reasonable and how it fits in, and can we also regularize the resulting pressure-determining equation (subsections 4.2 and 4.3).  At that point (i.e.~section 5.1) we can summarize our whole model.  Then we can help the actual user of our model by showing in what parameter limits we get some simpler or different models (section 5.2).}

\reply{p.25 l.11-19 as stated above, I don’t think this is quite the Schoof et al. (2012) model.}
{This is indeed the Schoof et al.~(2012) \cite{Schoofetal2012} model.  Equations (2.8)--(2.10) in \cite{Schoofetal2012} give our equation (36a).  Equation (2.12) in \cite{Schoofetal2012} is our equation (36b).}

\reply{p.27 l.23 write ``layer thickness'' instead of ``amount''\\
\indent p.28 l.1 write ``layer thickness'' instead of ``amount'' (and other places in the MS)}
{We somewhat agree.  First, our exposition of this particular list of observations has been simplified so that the issue does not arise.  \\
\indent Throughout the manuscript, when we refer to $W$ or $W_{til}$ in particular we generally use ``thickness''.  But ``water amount'' is an appropriate phrase when we want to contrast with other water properties, especially ``water pressure.''}

\reply{p.37 l.15 What happens when $W < 0$ should probably be discussed in the mathematical section too.}
{We have added some discussion of the appearance of free boundaries, from the enforcement of inequalities including $W\ge 0$, to subsection 5.1 on the continuum model.}

\reply{p.39 l.14 For a mountain glacier porosity seems to be around $0.01$ (Bartholomaus
et al., 2011).  Porosity for an ice sheet may be more on the order of $10^{-4}$.}
{Yes.  (Or rather, we don't doubt that perhaps someday a careful survey will reveal that to be so.)  The role of our englacial porosity in regularizing the solution, and in smoothing-out modeled temporal detail if it is too large, is already adequately covered.}

\reply{p.40 l.13 What is the ``active subglacial layer''?}
{That ambiguous phrase has been removed.  We now say ``There are also special cases at the boundaries of the region where $W > 0$ \dots''}

\reply{p.42 l.17 is this connected to the statement on p. 37, l.15? How?}
{Yes, it is connected.  Because literature including \cite{Hewittetal2012,Schoofetal2012,Werderetal2013} is modeling water input into mostly-temperate mountain glaciers, mostly from surface melt, that literature misses the point that $W\ge 0$ must be enforced.  That is, it must be enforced when there is refreeze, a known case under ice sheets.  Thus there are more-diverse free boundaries, and potential for conservation errors, in our physical model for ice sheets than in that literature.}

\reply{p.45 l.20 write ``The spin-up grid sequence...''}
{Done.}

\reply{45 Sec.9.2.1 This section is too long and detailed considering this is not about ice flow modelling.  Is this spin-up different from others used before?  Also in a similar
vein, Fig.~6~could be removed.}
{This section has been shortened, and Figure 6 removed, but nonetheless this material defines the meaning and quality of the input data into the subglacial hydrology model.  It cannot be removed entirely.}

\reply{p.48 l.5-7 The till is either completely full or empty.  If I understand the dependence of sliding on the till hydrology correctly, this means either fully slippery on not at all.  So, is there no dependence of sliding on hydrology?  Maybe this point could be briefly discussed.}
{There is dependence of sliding on hydrology.  While basal shear stress only directly depends on the amount of water in the till, not in the transport network, the model in its two-way coupled form can ``turn on'' and ``turn off'' ice streams for the correct (e.g.~at least from what is understood for Kamb ice stream) thermodynamically-determined reasons.\footnote{While none of the reviewers seem to note this aspect of subglacial hydrology, it is probably our highest priority, as revealed by all the papers on whole ice sheet modeling which we cite \dots all of which are ignored.} \\
\indent It is also true that when there is sufficient basal melt then the till in the model will be fully-saturated.  Is this asserted to be wrong? \\
\indent Finally it is very important to note that the velocity of sliding is \emph{not}, by any means, a local function of basal shear stress, much less hydrology.  PISM solves a nontrivial stress balance to determine where sliding occurs, implying high-quality results (in the sense of comparison to observed surface velocities in outlet glaciers \cite{AschwandenAdalgeirsdottirKhroulev}).}

\reply{\textbf{Comments for tables and figures}\\
Tab.~3 Why is $W_r$ so much higher here?}
{Table 3 itself is removed.  The particular value of a parameter in a verification test is rarely the issue.  We think both $W_r\approx 0.1$ m and $W_r\approx 1$ m are reasonable given the roughness seen in deglaciated areas.}

\reply{Fig.~2 Label $R_1$ and $L$.}
{The presentation of the nearly-exact solution has been made briefer and clearer, and the labels are not (now) needed.}

\reply{Fig 2 \& 3 they could be combined.}
{Perhaps as subplots, but our arrangment allows separate, and clearer, captions.  We want to show $W$ and $P$ separately.}

\reply{Fig.~6 could be left away}
{Done.}

\reply{Fig.~8 [sic; 9?] \& 11 mention what model run this is for}
{The Figure 8 caption is clear on which model.  The Figure 9 caption is clear that it is the same model as in Figure 8.  The Figure 11 caption (now Figure 10) has been corrected to make it clear it is \texttt{distributed}.}

\reply{Fig.~11 Add a label to the colour-scale. Also, I think there is a inconsistency between the caption and the text (p.48, l.18), one says ice thickness one says sliding speed.}
{The caption already says that the color scale is for ice thickness.  We are not sure what was the ``inconsistency between the caption and the text''.  We have re-written the caption to make it as clear as possible.}
\end{itemize}


\begin{thebibliography}{}
\providecommand{\natexlab}[1]{#1}
\providecommand{\url}[1]{{\tt #1}}
\providecommand{\urlprefix}{URL }
\expandafter\ifx\csname urlstyle\endcsname\relax
  \providecommand{\doi}[1]{doi:\discretionary{}{}{}#1}\else
  \providecommand{\doi}{doi:\discretionary{}{}{}\begingroup
  \urlstyle{rm}\Url}\fi

\bibitem{AschwandenAdalgeirsdottirKhroulev}
Aschwanden, A., Adalgeirsd{\'o}ttir, G., and Khroulev, C.: Hindcasting to
  measure ice sheet model sensitivity to initial states, The Cryosphere, 7,
  1083--1093, \doi{10.5194/tc-7-1083-2013}, 2013.

\bibitem{AschwandenBuelerKhroulevBlatter}
Aschwanden, A., Bueler, E., Khroulev, C., and Blatter, H.: An enthalpy
  formulation for glaciers and ice sheets, J. Glaciol., 58, 441--457,
  \doi{10.3189/2012JoG11J088}, 2012.

\bibitem{Bartholomausetal2011}
Bartholomaus, T.~C., Anderson, R.~S., and Anderson, S.~P.: Growth and collapse
  of the distributed subglacial hydrologic system of {K}ennicott {G}lacier,
  {A}laska, {USA}, and its effects on basal motion, J. Glaciol., 57, 985--1002,
  2011.

\bibitem{Bindschadler2013SeaRISE}
Bindschadler, R. et~al.: Ice-sheet model sensitivities to environmental forcing
  and their use in projecting future sea-level ({T}he {S}ea{RISE} {P}roject),
  J. Glaciol, 59, 195--224, 2013.

\bibitem{BBssasliding}
Bueler, E. and Brown, J.: Shallow shelf approximation as a ``sliding law'' in a
  thermodynamically coupled ice sheet model, J. Geophys. Res., 114, f03008,
  doi:10.1029/2008JF001179, 2009.

\bibitem{Clarke05}
Clarke, G.: Subglacial processes, Annu. Rev. Earth Planet. Sci., 33,
  247--276, \doi{10.1146/annurev.earth.33.092203.122621}, 2005.

\bibitem{deFleurianetal2014}
de~Fleurian, B., Gagliardini, O., Zwinger, T., Durand, G., Le~Meur, E., Mair,
  D., and R{\aa}back, P.: A double continuum hydrological model for glacier
  applications, The Cryosphere, 8, 137--153, \doi{10.5194/tc-8-137-2014}, 2014.

\bibitem{FlowersClarke2002}
Flowers, G.~E. and Clarke, G. K.~C.: A multicomponent coupled model of glacier
  hydrology 1. {T}heory and synthetic examples, J. Geophys. Res., 107, 2287,
  \doi{10.1029/2001JB001122}, 2002{\natexlab{a}}.

\bibitem{Goeller2014}
Goeller, S.: Antarctic {S}ubglacial {H}ydrology: {I}nteractions of subglacial lakes, basal water flow, and ice dynamics, PhD Dissertation, Universit\"at Bremen, 2014.

\bibitem{Hewitt2011}
Hewitt, I.~J.: Modelling distributed and channelized subglacial drainage: the
  spacing of channels, J. Glaciol., 57, 302--314, 2011.

\bibitem{Hewittetal2012}
Hewitt, I.~J., Schoof, C., and Werder, M.~A.: Flotation and free surface flow
  in a model for subglacial drainage. {P}art {II}: {C}hannel flow, J. Fluid
  Mech., 702, 157--188, 2012.

\bibitem{HoffmanPrice2014}
Hoffman, M. J. and Price, S.: Feedbacks between coupled subglacial hydrology and glacier dynamics, J. Geophys. Res. Earth Surf., 119, \doi{10.1002/2013JF002943}, 2014.

\bibitem{HundsdorferVerwer2010}
Hundsdorfer, W. and Verwer, J.~G.: Numerical {S}olution of {T}ime-{D}ependent
  {A}dvection-{D}iffusion-{R}eaction {E}quations, Springer Series in
  Computational Mathematics, Springer, 2010.

\bibitem{LeBrocqetal2009}
Le~Brocq, A., Payne, A., Siegert, M., and Alley, R.: A subglacial water-flow
  model for {W}est {A}ntarctica, J. Glaciol., 55, 879--888,
  \doi{10.3189/002214309790152564}, 2009.

\bibitem{LeVeque}
LeVeque, R.~J.: Finite Volume Methods for Hyperbolic Problems, Cambridge Texts
  in Applied Mathematics, Cambridge University Press, 2002.

\bibitem{Livingstoneetal2013}
Livingstone, S.~J., Clark, C.~D., Woodward, J., and Kingslake, J.: Potential
  subglacial lake locations and meltwater drainage pathways beneath the
  {A}ntarctic and {G}reenland ice sheets, The Cryosphere, 7, 1721--1740,
  \doi{10.5194/tc-7-1721-2013}, 2013.

\bibitem{MortonMayers}
Morton, K.~W. and Mayers, D.~F.: Numerical {S}olutions of {P}artial
  {D}ifferential {E}quations: {A}n {I}ntroduction, Cambridge University Press,
  2nd edn., 2005.

\bibitem{SchoofCoulombBlatter}
Schoof, C.: Coulomb friction and other sliding laws in a higher order glacier
  flow model, Math. Models Methods Appl. Sci. (M3AS), 20, 157--189,
  \doi{10.1142/S0218202510004180}, 2010{\natexlab{a}}.

\bibitem{Schoof2007deformable}
Schoof, C.: Cavitation on deformable glacier beds, SIAM J. Appl. Math., 67,
  1633--1653, 2007.

\bibitem{Schoofetal2012}
Schoof, C., Hewitt, I.~J., and Werder, M.~A.: Flotation and free surface flow
  in a model for subglacial drainage. {P}art {I}: {D}istributed drainage, J.
  Fluid Mech., 702, 126--156, 2012.

\bibitem{Siegertetal2009}
Siegert, M., Le~Brocq, A., and Payne, A.: Hydrological connections between
  Antarctic subglacial lakes, the flow of water beneath the East Antarctic Ice
  Sheet and implications for sedimentary processes, pp. 3--10, Wiley-Blackwell,
  2009.

\bibitem{Tulaczyketal2000}
Tulaczyk, S., Kamb, W.~B., and Engelhardt, H.~F.: Basal mechanics of {I}ce
  {S}tream {B}, {W}est {A}ntarctica 2.~{U}ndrained plastic bed model, J.
  Geophys. Res., 105, 483--494, 2000{\natexlab{b}}.

\bibitem{vanderWeletal2013}
van~der Wel, N., Christoffersen, P., and Bougamont, M.: The influence of
  subglacial hydrology on the flow of {K}amb {I}ce {S}tream, {W}est
  {A}ntarctica, J. Geophys. Res.: Earth Surface, 118, 1--14,
  \doi{10.1029/2012JF002570}, 2013.

\bibitem{Werderetal2013}
Werder, M., Hewitt, I., Schoof, C., and Flowers, G.: Modeling channelized and
  distributed subglacial drainage in two dimensions, J Geophys. Res.: Earth
  Surface, 118, 2140--2158, 2013.
\end{thebibliography}


\end{document}

